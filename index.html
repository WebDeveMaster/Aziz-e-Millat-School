<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aziz-e-Millat School - Fee Management System</title>
    <link rel="stylesheet" href="https://webdevemaster.github.io/Aziz-e-Millat-School/output.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f8fafc;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .page {
            display: none;
            flex: 1;
        }

        .active-page {
            display: block;
        }

        main {
            flex: 1;
        }

        footer {
            margin-top: auto;
        }
    </style>
</head>

<body>
    <!-- Navbar -->
    <nav class="bg-blue-800 text-white shadow-lg sticky top-0 z-50">
        <div class="container mx-auto px-4 py-3 flex flex-wrap items-center justify-between">
            <div class="flex items-center" onclick="location.reload();">
                <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiNmZmZmZmYiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cGF0aCBkPSJNMiAzaDZhNCA0IDAgMCAxIDQgNHY0YTQgNCAwIDAgMS00IDRIMnYtMTJ6Ij48L3BhdGg+PHBhdGggZD0iTTIyIDNoLTZhNCA0IDAgMCAwLTQgNHY0YTQgNCAwIDAgMCA0IDRoNlYzeiI+PC9wYXRoPjxwYXRoIGQ9Ik0yIDE1aDZhNCA0IDAgMCAxIDQgNHYySDJ2LTZ6Ij48L3BhdGg+PHBhdGggZD0iTTIyIDE1aC02YTQgNCAwIDAgMC00IDR2MmgxMHYtNnoiPjwvcGF0aD48L3N2Zz4="
                    alt="Logo" class="h-8 w-8 sm:h-10 sm:w-10">
                    
                <!-- <img src="/school logo p.png"
                    alt="Logo" class="h-8 w-8 sm:h-10 sm:w-10" style="height: 25px; width: 25px;"> -->

                <span class="ml-2 text-lg sm:text-xl font-bold" style="font-size: medium;">Aziz-e-Millat School</span>
            </div>
            <div class="block lg:hidden">
                <button id="mobile-menu-button"
                    class="flex items-center px-3 py-2 border text-blue-200 border-blue-400 hover:text-white hover:border-white">
                    <svg class="fill-current h-4 w-4" viewBox="0 0 20 20" >
                        <title>Menu</title>
                        <path d="M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v-2z" />
                    </svg>
                </button>
            </div>
            <div id="menu"
                class="w-full hidden flex-grow lg:flex lg:items-center lg:w-auto absolute lg:static top-14 left-0 bg-blue-800 lg:bg-transparent z-50">
                <div class="text-sm lg:flex-grow px-4 py-2 lg:p-0" style="padding-left: 20px;">
                    <a href="#" class="nav-link block py-2 lg:inline-block lg:mt-0 text-blue-200 hover:text-white mr-4"
                        data-page="home">Home</a>
                    <a href="#" class="nav-link block py-2 lg:inline-block lg:mt-0 text-blue-200 hover:text-white mr-4"
                        data-page="pay-fees">Pay Fees</a>
                    <a href="#" class="nav-link block py-2 lg:inline-block lg:mt-0 text-blue-200 hover:text-white"
                        data-page="about">About Us</a>
                </div>
                <div class="px-4 py-2 lg:p-0">
                    <a href="#"
                        class="nav-link block lg:inline-block text-sm px-4 py-2 leading-none border text-white border-white hover:border-transparent hover:text-blue-800 hover:bg-white"
                        data-page="dashboard">Admin Dashboard</a>
                </div>
            </div>
        </div>
    </nav>
    </invoke>

    <main>
        <!-- Home Page -->
        <div id="home" class="page active-page">
            <!-- Hero Section: Professional Modern Design -->
            <div class="relative bg-gradient-to-br from-blue-800 via-blue-900 to-blue-950 text-white py-10 sm:py-16 shadow-lg" style="font-family: 'Inter', 'Segoe UI', Arial, sans-serif; font-size: 0.95rem;">
                <div class="absolute inset-0 opacity-20 pointer-events-none" style="background: url('https://www.transparenttextures.com/patterns/diamond-upholstery.png');"></div>
                <div class="container mx-auto px-4 flex flex-col items-center justify-center text-center relative z-10">
                    
                    <div style="height: 150px;"></div>
                    <div class="mb-6" style="margin-bottom: 3px;">
                        <span class="inline-block bg-blue-900 bg-opacity-80 px-3 py-1 rounded-full text-xs font-semibold tracking-wide shadow-lg border border-blue-700" style="font-size: 0.8rem;">
                            Montessori to Matric
                        </span>
                    </div>
                    <h1 class="text-2xl sm:text-3xl font-bold mb-2 sm:mb-3 drop-shadow-lg" style="width: 90%; letter-spacing: 0.5px; font-size: 1.2rem;">
                        Welcome to Aziz-e-Millat School
                    </h1>
                    <p class="text-sm sm:text-base mb-6 sm:mb-8 max-w-2xl mx-auto text-blue-100 font-medium" style="width: 90%; letter-spacing: 0.2px; font-size: 0.9rem;">
                        Shaping the future of our nation with excellence, integrity, and innovation.
                    </p>

                    <div style="height: 125px;"></div>

                    <button
                        class="nav-link bg-gradient-to-r from-blue-400 to-blue-700 text-white font-bold py-2 px-6 rounded-xl shadow-xl transition duration-300 transform hover:scale-105 hover:from-blue-500 hover:to-blue-900 focus:outline-none focus:ring-2 focus:ring-blue-400 w-full sm:w-auto text-base"
                        data-page="pay-fees"
                        style="max-width: 220px; font-size: 0.9rem;">
                        Pay School Fees
                    </button>
                    <div class="mt-8 flex flex-col sm:flex-row gap-2 justify-center items-center" style="margin-top: 17px;">
                        <div class="flex items-center gap-2">
                            <span class="inline-block w-2 h-2 rounded-full bg-blue-400"></span>
                            <span class="text-xs text-blue-200 font-medium" style="font-size: 0.75rem;">Secure Online Payments</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <span class="inline-block w-2 h-2 rounded-full bg-blue-600"></span>
                            <span class="text-xs text-blue-200 font-medium" style="font-size: 0.75rem;">24/7 Access</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <span class="inline-block w-2 h-2 rounded-full bg-blue-800"></span>
                            <span class="text-xs text-blue-200 font-medium" style="font-size: 0.75rem;">Trusted by Parents</span>
                        </div>
                    </div>
                    
                    <div style="height: 20px;"></div>
                </div>
                <!-- Decorative SVG wave bottom -->
                <div class="absolute bottom-0 left-0 w-full overflow-hidden leading-none">
                    <svg viewBox="0 0 1200 120" preserveAspectRatio="none" class="w-full h-12 sm:h-16" style="display: block;"></svg>
                        <path d="M0,0V46.29c47.09,22,104.37,35.05,158,28.57,70.22-8.53,136.07-44.6,207-38.85,74.48,6,142.74,49.93,218,54.72,63.6,4.17,127.09-19.7,186-43.86,54.13-22.09,104.37-48.44,162-55.41,51.41-6.16,99.09,9.94,146,24.28V0Z" opacity="0.2" fill="#1e3a8a"></path>
                        <path d="M0,0V16.81c47.09,22,104.37,35.05,158,28.57,70.22-8.53,136.07-44.6,207-38.85,74.48,6,142.74,49.93,218,54.72,63.6,4.17,127.09-19.7,186-43.86,54.13-22.09,104.37-48.44,162-55.41,51.41-6.16,99.09,9.94,146,24.28V0Z" opacity="0.4" fill="#2563eb"></path>
                    </svg>
                </div>
            </div>

            <!-- School Details Section -->
            <div class="container mx-auto px-4 py-8 sm:py-12">
                <div class="bg-white rounded-lg shadow-lg p-4 sm:p-6 mb-8 sm:mb-12">
                    <h2 class="text-1x1 sm:text-3xl font-bold text-center text-blue-800 mb-6 sm:mb-8">School Details
                    </h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 sm:gap-8">
                        <div>
                            <h3 class="text-lg sm:text-xl font-semibold mb-3 sm:mb-4"  style="font-size: 89%;">About Aziz-e-Millat School</h3>
                            <p class="text-gray-700 mb-4"  style="font-size: 82%;">Established with a vision to provide quality education,
                                Aziz-e-Millat School has been serving the community for years with excellence and
                                dedication.</p>
                            <ul class="list-disc list-inside text-gray-700 space-y-2">
                                <li style="font-size: 78%;">Comprehensive education from Montessori to Matric</li>
                                <li style="font-size: 78%;">Qualified and experienced teaching staff</li>
                                <li style="font-size: 78%;">Modern facilities and learning environment</li>
                                <li style="font-size: 78%;">Focus on character building and academic excellence</li>
                            </ul>
                        </div>
                        <div>
                            <h3 class="text-lg sm:text-xl font-semibold mb-3 sm:mb-4 mt-6 md:mt-0" style="font-size: 87%;">Programs Offered</h3>
                            <div class="grid grid-cols-2 gap-3 sm:gap-4">
                                <div class="bg-blue-50 p-3 sm:p-4 rounded-lg">
                                    <h4 class="font-medium text-blue-800" style="font-size: 82%;">Montessori</h4>
                                    <p class="text-sm text-gray-600" style="font-size: 85%;">Ages 3-5</p>
                                </div>
                                <div class="bg-blue-50 p-3 sm:p-4 rounded-lg">
                                    <h4 class="font-medium text-blue-800" style="font-size: 82%;">Primary</h4>
                                    <p class="text-sm text-gray-600" style="font-size: 85%;">Classes 1-5</p>
                                </div>
                                <div class="bg-blue-50 p-3 sm:p-4 rounded-lg">
                                    <h4 class="font-medium text-blue-800" style="font-size: 82%;">Middle</h4>
                                    <p class="text-sm text-gray-600" style="font-size: 85%;">Classes 6-8</p>
                                </div>
                                <div class="bg-blue-50 p-3 sm:p-4 rounded-lg">
                                    <h4 class="font-medium text-blue-800" style="font-size: 82%;">Matric</h4>
                                    <p class="text-sm text-gray-600" style="font-size: 85%;">Classes 9-10</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>


                <h2 class="text-1xl sm:text-3xl font-bold text-center text-blue-800 mb-6 sm:mb-8" style="font-size: large;">Our Leadership</h2>

                <div class="flex flex- justify-center gap-4 sm:gap-6">
                    <!-- CARD 1 -->
                    <div class="flex flex-col items-center bg-white rounded-xl shadow-lg p-4 sm:p-6 w-40 sm:w-56 hover:scale-105 transition-transform duration-300 border border-blue-100">
                        <div class="w-16 h-16 sm:w-24 sm:h-24 rounded-full bg-gradient-to-br from-blue-200 to-blue-400 flex items-center justify-center mb-2 sm:mb-3 shadow-md">
                            <svg class="w-10 h-10 sm:w-14 sm:h-14 text-blue-700"  fill="none"
                                viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                                    d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                            </svg>
                        </div>
                        <h3 class="text-sm sm:text-base font-semibold text-blue-900 mb-0.5 sm:mb-1">Mr. Ahmed Khan</h3>
                        <p class="text-blue-600 text-xs font-medium tracking-wide">Principal</p>
                    </div>
                    <!-- CARD 1 -->
                    <div class="flex flex-col items-center bg-white rounded-xl shadow-lg p-4 sm:p-6 w-40 sm:w-56 hover:scale-105 transition-transform duration-300 border border-blue-100">
                        <div class="w-16 h-16 sm:w-24 sm:h-24 rounded-full bg-gradient-to-br from-blue-200 to-blue-400 flex items-center justify-center mb-2 sm:mb-3 shadow-md">
                            <svg class="w-10 h-10 sm:w-14 sm:h-14 text-blue-700"  fill="none"
                                viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                                    d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                            </svg>
                        </div>
                        <h3 class="text-sm sm:text-base font-semibold text-blue-900 mb-0.5 sm:mb-1">Mr. Ahmed Khan</h3>
                        <p class="text-blue-600 text-xs font-medium tracking-wide">Principal</p>
                    </div>
                </div>
                <br>
                <div class="flex flex- justify-center gap-4 sm:gap-6">
                    <!-- CARD 1 -->
                    <div class="flex flex-col items-center bg-white rounded-xl shadow-lg p-4 sm:p-6 w-40 sm:w-56 hover:scale-105 transition-transform duration-300 border border-blue-100">
                        <div class="w-16 h-16 sm:w-24 sm:h-24 rounded-full bg-gradient-to-br from-blue-200 to-blue-400 flex items-center justify-center mb-2 sm:mb-3 shadow-md">
                            <svg class="w-10 h-10 sm:w-14 sm:h-14 text-blue-700"  fill="none"
                                viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                                    d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                            </svg>
                        </div>
                        <h3 class="text-sm sm:text-base font-semibold text-blue-900 mb-0.5 sm:mb-1">Mr. Ahmed Khan</h3>
                        <p class="text-blue-600 text-xs font-medium tracking-wide">Principal</p>
                    </div>
                    <!-- CARD 1 -->
                    <div class="flex flex-col items-center bg-white rounded-xl shadow-lg p-4 sm:p-6 w-40 sm:w-56 hover:scale-105 transition-transform duration-300 border border-blue-100">
                        <div class="w-16 h-16 sm:w-24 sm:h-24 rounded-full bg-gradient-to-br from-blue-200 to-blue-400 flex items-center justify-center mb-2 sm:mb-3 shadow-md">
                            <svg class="w-10 h-10 sm:w-14 sm:h-14 text-blue-700"  fill="none"
                                viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                                    d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                            </svg>
                        </div>
                        <h3 class="text-sm sm:text-base font-semibold text-blue-900 mb-0.5 sm:mb-1">Mr. Ahmed Khan</h3>
                        <p class="text-blue-600 text-xs font-medium tracking-wide">Principal</p>
                    </div>
                </div>
                <!-- Leadership Carousel: Modern, Professional, Responsive, Smooth Animation
                <div class="relative w-full py-8 bg-gradient-to-r from-blue-50 to-blue-100 rounded-xl shadow-inner overflow-hidden">
                    <div class="pointer-events-none absolute left-0 top-0 h-full w-16 z-10 hidden sm:block" style="background: linear-gradient(to right, #f1f5f9 90%, transparent);"></div>
                    <div class="pointer-events-none absolute right-0 top-0 h-full w-16 z-10 hidden sm:block" style="background: linear-gradient(to left, #f1f5f9 90%, transparent);"></div>
                    <div class="flex gap-6 sm:gap-8 animate-leadership-scroll min-w-[200%]">
                        <div class="flex gap-6 sm:gap-8 w-full">
                            <div class="flex flex-col items-center bg-white rounded-xl shadow-lg p-4 sm:p-6 w-40 sm:w-56 hover:scale-105 transition-transform duration-300 border border-blue-100">
                                <div class="w-16 h-16 sm:w-24 sm:h-24 rounded-full bg-gradient-to-br from-blue-200 to-blue-400 flex items-center justify-center mb-2 sm:mb-3 shadow-md">
                                    <svg class="w-10 h-10 sm:w-14 sm:h-14 text-blue-700"  fill="none"
                                        viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                                            d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                                    </svg>
                                </div>
                                <h3 class="text-sm sm:text-base font-semibold text-blue-900 mb-0.5 sm:mb-1">Mr. Ahmed Khan</h3>
                                <p class="text-blue-600 text-xs font-medium tracking-wide">Principal</p>
                            </div>
                            <div class="flex flex-col items-center bg-white rounded-xl shadow-lg p-4 sm:p-6 w-40 sm:w-56 hover:scale-105 transition-transform duration-300 border border-blue-100">
                                <div class="w-16 h-16 sm:w-24 sm:h-24 rounded-full bg-gradient-to-br from-pink-200 to-pink-400 flex items-center justify-center mb-2 sm:mb-3 shadow-md">
                                    <svg class="w-10 h-10 sm:w-14 sm:h-14 text-pink-700"  fill="none"
                                        viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                                            d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                                    </svg>
                                </div>
                                <h3 class="text-sm sm:text-base font-semibold text-blue-900 mb-0.5 sm:mb-1">Mrs. Fatima Ali</h3>
                                <p class="text-blue-600 text-xs font-medium tracking-wide">Vice Principal</p>
                            </div>
                            <div class="flex flex-col items-center bg-white rounded-xl shadow-lg p-4 sm:p-6 w-40 sm:w-56 hover:scale-105 transition-transform duration-300 border border-blue-100">
                                <div class="w-16 h-16 sm:w-24 sm:h-24 rounded-full bg-gradient-to-br from-green-200 to-green-400 flex items-center justify-center mb-2 sm:mb-3 shadow-md">
                                    <svg class="w-10 h-10 sm:w-14 sm:h-14 text-green-700"  fill="none"
                                        viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                                            d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                                    </svg>
                                </div>
                                <h3 class="text-sm sm:text-base font-semibold text-blue-900 mb-0.5 sm:mb-1">Mr. Usman Malik</h3>
                                <p class="text-blue-600 text-xs font-medium tracking-wide">Head Admin</p>
                            </div>
                        </div>
                        <div class="flex gap-6 sm:gap-8 w-full">
                            <div class="flex flex-col items-center bg-white rounded-xl shadow-lg p-4 sm:p-6 w-40 sm:w-56 hover:scale-105 transition-transform duration-300 border border-blue-100">
                                <div class="w-16 h-16 sm:w-24 sm:h-24 rounded-full bg-gradient-to-br from-blue-200 to-blue-400 flex items-center justify-center mb-2 sm:mb-3 shadow-md">
                                    <svg class="w-10 h-10 sm:w-14 sm:h-14 text-blue-700"  fill="none"
                                        viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                                            d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                                    </svg>
                                </div>
                                <h3 class="text-sm sm:text-base font-semibold text-blue-900 mb-0.5 sm:mb-1">Mr. Ahmed Khan</h3>
                                <p class="text-blue-600 text-xs font-medium tracking-wide">Principal</p>
                            </div>
                            <div class="flex flex-col items-center bg-white rounded-xl shadow-lg p-4 sm:p-6 w-40 sm:w-56 hover:scale-105 transition-transform duration-300 border border-blue-100">
                                <div class="w-16 h-16 sm:w-24 sm:h-24 rounded-full bg-gradient-to-br from-pink-200 to-pink-400 flex items-center justify-center mb-2 sm:mb-3 shadow-md">
                                    <svg class="w-10 h-10 sm:w-14 sm:h-14 text-pink-700"  fill="none"
                                        viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                                            d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                                    </svg>
                                </div>
                                <h3 class="text-sm sm:text-base font-semibold text-blue-900 mb-0.5 sm:mb-1">Mrs. Fatima Ali</h3>
                                <p class="text-blue-600 text-xs font-medium tracking-wide">Vice Principal</p>
                            </div>
                            <div class="flex flex-col items-center bg-white rounded-xl shadow-lg p-4 sm:p-6 w-40 sm:w-56 hover:scale-105 transition-transform duration-300 border border-blue-100">
                                <div class="w-16 h-16 sm:w-24 sm:h-24 rounded-full bg-gradient-to-br from-green-200 to-green-400 flex items-center justify-center mb-2 sm:mb-3 shadow-md">
                                    <svg class="w-10 h-10 sm:w-14 sm:h-14 text-green-700"  fill="none"
                                        viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                                            d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                                    </svg>
                                </div>
                                <h3 class="text-sm sm:text-base font-semibold text-blue-900 mb-0.5 sm:mb-1">Mr. Usman Malik</h3>
                                <p class="text-blue-600 text-xs font-medium tracking-wide">Head Admin</p>
                            </div>
                        </div>
                    </div>
                    <style>
                        @keyframes leadership-scroll {
                            0% { transform: translateX(0); }
                            100% { transform: translateX(-50%); }
                        }
                        .animate-leadership-scroll {
                            animation: leadership-scroll 18s linear infinite;
                        }
                        /* Responsive adjustments for mobile */
                        @media (max-width: 640px) {
                            .animate-leadership-scroll > div > div {
                                width: 10rem !important;
                                padding: 1rem !important;
                            }
                            .animate-leadership-scroll {
                                gap: 1.25rem !important;
                            }
                            /* Make carousel slower on mobile for readability */
                            .animate-leadership-scroll {
                                animation-duration: 8s !important;
                            }
                        }
                    </style>
                </div> -->
            </div>
        </div>

        <!-- Pay Fees Page -->
        <div id="pay-fees" class="page">
            <div class="container mx-auto px-4 py-6 sm:py-12">
                <!-- <div style="height: 40px;"></div> -->
                
                <!-- Student Login Form -->
                <h1 class="text-xl sm:text-2xl font-bold text-center text-blue-800 mb-4 sm:mb-6" style="font-size: 95%;">Student Fee Payment</h1>
                <div id="student-login" class="max-w-md mx-auto bg-white rounded-lg shadow-lg p-3 sm:p-5" style="padding: 20px;">
                    <h2 class="text-base sm:text-lg font-semibold mb-3 text-blue-800">Student Information</h2>
                    <div class="mb-3">
                        <label class="block text-gray-700 text-xs font-bold mb-1" for="class">
                            Class
                        </label>
                        <div class="relative">
                            <select id="class"
                                class="shadow appearance-none border rounded w-full py-2 px-3 text-sm text-gray-700 leading-tight focus:outline-none focus:shadow-outline pr-8">
                                <option style="font-size: 80%;" value="">Select Class</option>
                                <option style="font-size: 80%;" value="0">Montessori</option>
                                <option style="font-size: 80%;" value="1">Class 1</option>
                                <option style="font-size: 80%;" value="2">Class 2</option>
                                <option style="font-size: 80%;" value="3">Class 3</option>
                                <option style="font-size: 80%;" value="4">Class 4</option>
                                <option style="font-size: 80%;" value="5">Class 5</option>
                                <option style="font-size: 80%;" value="6">Class 6</option>
                                <option style="font-size: 80%;" value="7">Class 7</option>
                                <option style="font-size: 80%;" value="8">Class 8</option>
                                <option style="font-size: 80%;" value="9">Class 9</option>
                                <option style="font-size: 80%;" value="10">Class 10</option>
                            </select>
                            <div
                                class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700">
                                <svg class="fill-current h-3 w-3" 
                                    viewBox="0 0 20 20">
                                    <path
                                        d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z" />
                                </svg>
                            </div>
                        </div>
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-xs font-bold mb-1" for="roll-number">
                            Roll Number
                        </label>
                        <input id="roll-number" type="text"
                            class="shadow appearance-none border rounded w-full py-2 px-3 text-sm text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                            placeholder="Enter Roll Number"
                            style="font-size: 80%;">
                    </div>
                    
                    <div class="mb-4">
                        <label class="block text-gray-700 text-xs font-bold mb-1" for="roll-number">
                            Password
                        </label>
                        <input id="password" type="text"
                            class="shadow appearance-none border rounded w-full py-2 px-3 text-sm text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                            placeholder="Enter Password / Set Password / Admin Password"
                            style="font-size: 80%;"
                        />
                    </div>

                    <div style="height: 20px;"></div>
                    <div id="login-container" class="flex flex-col items-center">
                        <div class="flex items-center justify-center">
                            <button id="login-btn"
                                class="bg-blue-800 hover:bg-blue-900 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline transition duration-300 w-full sm:w-auto text-sm"
                                style="font-size: 90%; height: 40px;">
                                Login
                            </button>
                        </div>
                    </div>
                    <div style="height: 200px;"></div>
                </div>

                <!-- Fees Details (Hidden initially) -->
                <div id="fees-details"
                    class="max-w-4xl mx-auto bg-white rounded-lg shadow-lg p-3 sm:p-5 mt-4 sm:mt-6 hidden">
                    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-3 sm:mb-4">
                        <h2 class="text-base sm:text-lg font-semibold text-blue-800 mb-1 sm:mb-0">Student Fee Details
                        </h2>
                        <div class="text-xs sm:text-sm">
                            <div><span class="font-bold">Student: </span><span id="student-name">Ahmed Khan</span></div>

                            <div class="flex space-x-3" style="margin-top: 5px;">
                                <div><span class="font-bold">Class: </span><span id="student-class">8</span></div>
                                <div><span class="font-bold">Roll No: </span><span id="student-roll">123</span></div>
                            </div>
                            <div style="height: 17px;"></div>
                            <button id="logout-btn"
                                class="bg-red-900 hover:bg-red-900 text-white font-bold py-2 px-4 rounded-lg focus:outline-none focus:shadow-outline transition duration-300 disabled:opacity-80 disabled:cursor-not-allowed w-full sm:w-auto text-sm"
                                style="font-size: 96%; height: 40px;">
                                Logout
                            </button>
                            <div style="height: 22px;"></div>
                        </div>
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                    <!-- Pending Fees Section -->
                    <div style="max-width: 500px; margin-bottom: 50px;">
                        <h3 class="font-semibold text-blue-800 mb-6" style="margin-bottom: 3px;">Pending Fees</h3>
                        <p style="font-size: 80%;">After Due Date you have need to pay extra</p>
                        <p style="font-size: 80%;"><b id="extra-paying-pkr">100</b> PKR</p>
                        <hr>
                        <div style="height: 20px;"></div>

                        <div class="overflow-x-auto mb-4 sm:mb-6 bg-gray-100 rounded-lg" style="padding: 3px;">
                            <table class="min-w-full bg-white" id="pending-table">
                                <thead  style="height: 40px;">
                                    <tr>
                                        <th
                                            class="py-1 px-1 sm:px-3 border-b border-gray-200 bg-gray-50 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                            Select</th>
                                        <th
                                            class="py-1 px-1 sm:px-3 border-b border-gray-200 bg-gray-50 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                            Due Date</th>
                                        <th
                                            class="py-1 px-1 sm:px-3 border-b border-gray-200 bg-gray-50 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                            Purpose</th>
                                        <th
                                            class="py-1 px-1 sm:px-3 border-b border-gray-200 bg-gray-50 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                            Amount</th>
                                        <th
                                            class="py-1 px-1 sm:px-3 border-b border-gray-200 bg-gray-50 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                            Status</th>
                                    </tr>
                                </thead>
                                
                                <tbody>
                                    <tr>
                                        <td class="py-2 px-1 sm:px-3 border-b border-gray-200">
                                            <input type="checkbox" class="fee-checkbox w-4 h-4" data-amount="5000"
                                                data-fee-id="1" data-purpose="Monthly Fee (January)"
                                                data-due-date="2023-01-10">
                                        </td>
                                        <td class="py-2 px-1 sm:px-3 border-b border-gray-200 text-xs">10-01-2023</td>
                                        <td class="py-2 px-1 sm:px-3 border-b border-gray-200 text-xs">Monthly Fee (January)
                                        </td>
                                        <td class="py-2 px-1 sm:px-3 border-b border-gray-200 text-xs font-medium">5,000
                                        </td>
                                        <td class="py-2 px-1 sm:px-3 border-b border-gray-200"><span
                                                class="px-1 py-0.5 text-xs rounded-full bg-yellow-100 text-yellow-800">Unpaid</span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="py-2 px-1 sm:px-3 border-b border-gray-200">
                                            <input type="checkbox" class="fee-checkbox w-4 h-4" data-amount="2500"
                                                data-fee-id="2" data-purpose="Computer Lab Fee" data-due-date="2023-01-15">
                                        </td>
                                        <td class="py-2 px-1 sm:px-3 border-b border-gray-200 text-xs">15-01-2023</td>
                                        <td class="py-2 px-1 sm:px-3 border-b border-gray-200 text-xs">Computer Lab Fee</td>
                                        <td class="py-2 px-1 sm:px-3 border-b border-gray-200 text-xs font-medium">2,500
                                        </td>
                                        <td class="py-2 px-1 sm:px-3 border-b border-gray-200"><span
                                                class="px-1 py-0.5 text-xs rounded-full bg-yellow-100 text-yellow-800">Unpaid</span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="py-2 px-1 sm:px-3 border-b border-gray-200">
                                            <input type="checkbox" class="fee-checkbox w-4 h-4" data-amount="1500"
                                                data-fee-id="3" data-purpose="Exam Fee" data-due-date="2023-01-20">
                                        </td>
                                        <td class="py-2 px-1 sm:px-3 border-b border-gray-200 text-xs">20-01-2023</td>
                                        <td class="py-2 px-1 sm:px-3 border-b border-gray-200 text-xs">Exam Fee</td>
                                        <td class="py-2 px-1 sm:px-3 border-b border-gray-200 text-xs font-medium">1,500
                                        </td>
                                        <td class="py-2 px-1 sm:px-3 border-b border-gray-200"><span
                                                class="px-1 py-0.5 text-xs rounded-full bg-yellow-100 text-yellow-800">Unpaid</span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="py-2 px-1 sm:px-3 border-b border-gray-200">
                                            <input type="checkbox" class="fee-checkbox w-4 h-4" data-amount="5000"
                                                data-fee-id="4" data-purpose="Monthly Fee (February)"
                                                data-due-date="2023-02-10">
                                        </td>
                                        <td class="py-2 px-1 sm:px-3 border-b border-gray-200 text-xs">10-02-2023</td>
                                        <td class="py-2 px-1 sm:px-3 border-b border-gray-200 text-xs">Monthly Fee
                                            (February)</td>
                                        <td class="py-2 px-1 sm:px-3 border-b border-gray-200 text-xs font-medium">5,000
                                        </td>
                                        <td class="py-2 px-1 sm:px-3 border-b border-gray-200"><span
                                                class="px-1 py-0.5 text-xs rounded-full bg-yellow-100 text-yellow-800">Unpaid</span>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <div class="mt-4 flex flex-col sm:flex-row justify-between items-center bg-blue-50 p-3 rounded-lg">
                            <div class="mb-3 sm:mb-0 text-center sm:text-left">
                                <span class="font-bold text-sm sm:text-base" style="font-size: small;">Total Selected: </span>
                                <span id="total-amount" class="font-bold text-base sm:text-lg text-blue-800" style="font-size: small;">0</span> <span
                                    class="font-bold text-sm sm:text-base" style="font-size: small;">PKR</span>

                                <!-- <span id="total-amount-afterDue" class="font-bold text-base sm:text-lg text-red-800" style="font-size: small;">+ ₹100 late fee</span> -->
                            </div>
                            <button id="pay-now-btn"
                                class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg focus:outline-none focus:shadow-outline transition duration-300 disabled:opacity-50 disabled:cursor-not-allowed w-full sm:w-auto text-sm"
                                disabled
                                style="font-size: small;">
                                Pay Now
                            </button>
                        </div>
                    </div>
                    <!-- Paid Fees History Section -->
                    <div style="max-width: 500px;">
                        <h3 class="font-semibold text-blue-800 mb-6" style="margin-bottom: 7px;">Paid Fees History</h3>
                        <div class="overflow-x-auto mb-4 bg-gray-100 rounded-lg" style="padding: 3px;"> 
                            <div class="max-h-[400px] overflow-y-auto border border-gray-200 rounded-md">
                                <table class="min-w-full bg-white" id="paid-table">
                                    <thead  class="sticky top-0 bg-gray-50 z-10" style="height: 40px;">
                                        <tr>
                                            <th
                                                class="py-1 px-1 sm:px-3 border-b border-gray-200 bg-gray-50 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                                Pay Date</th>
                                            <th
                                                class="py-1 px-1 sm:px-3 border-b border-gray-200 bg-gray-50 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                                Due Date</th>
                                            <th
                                                class="py-1 px-1 sm:px-3 border-b border-gray-200 bg-gray-50 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                                Purpose</th>
                                            <th
                                                class="py-1 px-1 sm:px-3 border-b border-gray-200 bg-gray-50 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                                Amount</th>
                                            <th
                                                class="py-1 px-1 sm:px-3 border-b border-gray-200 bg-gray-50 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                                Status</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td class="py-2 px-1 sm:px-3 border-b border-gray-200 text-xs">05-12-2022</td>
                                            <td class="py-2 px-1 sm:px-3 border-b border-gray-200 text-xs">01-12-2022</td>
                                            <td class="py-2 px-1 sm:px-3 border-b border-gray-200 text-xs">Monthly Fee
                                                (December)</td>
                                            <td class="py-2 px-1 sm:px-3 border-b border-gray-200 text-xs">5,000</td>
                                            <td class="py-2 px-1 sm:px-3 border-b border-gray-200"><span
                                                    class="px-1 py-0.5 text-xs rounded-full bg-green-100 text-green-800">Paid</span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="py-2 px-1 sm:px-3 border-b border-gray-200 text-xs">10-11-2022</td>
                                            <td class="py-2 px-1 sm:px-3 border-b border-gray-200 text-xs">05-11-2022</td>
                                            <td class="py-2 px-1 sm:px-3 border-b border-gray-200 text-xs">Monthly Fee
                                                (November)</td>
                                            <td class="py-2 px-1 sm:px-3 border-b border-gray-200 text-xs">5,000</td>
                                            <td class="py-2 px-1 sm:px-3 border-b border-gray-200"><span
                                                    class="px-1 py-0.5 text-xs rounded-full bg-green-100 text-green-800">Paid</span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="py-2 px-1 sm:px-3 border-b border-gray-200 text-xs">15-10-2022</td>
                                            <td class="py-2 px-1 sm:px-3 border-b border-gray-200 text-xs">10-10-2022</td>
                                            <td class="py-2 px-1 sm:px-3 border-b border-gray-200 text-xs">Exam Fee</td>
                                            <td class="py-2 px-1 sm:px-3 border-b border-gray-200 text-xs">1,500</td>
                                            <td class="py-2 px-1 sm:px-3 border-b border-gray-200"><span
                                                    class="px-1 py-0.5 text-xs rounded-full bg-green-100 text-green-800">Paid</span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="py-2 px-1 sm:px-3 border-b border-gray-200 text-xs">03-10-2022</td>
                                            <td class="py-2 px-1 sm:px-3 border-b border-gray-200 text-xs">01-10-2022</td>
                                            <td class="py-2 px-1 sm:px-3 border-b border-gray-200 text-xs">Monthly Fee (October)
                                            </td>
                                            <td class="py-2 px-1 sm:px-3 border-b border-gray-200 text-xs">5,000</td>
                                            <td class="py-2 px-1 sm:px-3 border-b border-gray-200"><span
                                                    class="px-1 py-0.5 text-xs rounded-full bg-green-100 text-green-800">Paid</span>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    </div>
                </div>

                <!-- Payment Gateway (Hidden initially) -->
                <div id="payment-gateway"
                    class="max-w-md mx-auto bg-white rounded-lg shadow-lg p-3 sm:p-5 mt-4 sm:mt-6 hidden">
                    <div class="text-center mb-4">
                        <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDA4ODAwIiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCI+PHJlY3QgeD0iMSIgeT0iNCIgd2lkdGg9IjIyIiBoZWlnaHQ9IjE2IiByeD0iMiIgcnk9IjIiPjwvcmVjdD48bGluZSB4MT0iMSIgeTE9IjEwIiB4Mj0iMjMiIHkyPSIxMCI+PC9saW5lPjwvc3ZnPg=="
                            alt="EasyPaisa" class="mx-auto mb-1" style="width:100px;height:50px;">
                        <h2 class="text-base sm:text-lg font-semibold text-green-800">EasyPaisa Payment Gateway</h2>
                    </div>

                    <div class="mb-4">
                        <label class="block text-gray-700 text-xs font-bold mb-1" for="phone">
                            Mobile Number
                        </label>
                        <input id="phone" type="tel" inputmode="numeric"
                            class="shadow appearance-none border rounded w-full py-2 px-3 text-sm text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                            placeholder="03XX-XXXXXXX">
                    </div>

                    <div class="bg-green-50 p-3 rounded-lg mb-4">
                        <p class="text-gray-700 mb-1 text-center text-sm"><span class="font-bold">Amount to Pay:</span>
                            <span id="gateway-amount" class="text-base font-bold text-green-800">0</span> PKR</p>
                        <p class="text-xs text-gray-500 text-center">You will receive a confirmation code on your mobile
                            number.</p>
                    </div>

                    <div class="flex flex-col sm:flex-row items-center gap-2 sm:justify-between">
                        <button id="cancel-payment"
                            class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-3 rounded-lg focus:outline-none focus:shadow-outline transition duration-300 w-full sm:w-auto order-2 sm:order-1 text-sm">
                            Cancel
                        </button>
                        <button id="confirm-payment"
                            class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-3 rounded-lg focus:outline-none focus:shadow-outline transition duration-300 w-full sm:w-auto order-1 sm:order-2 text-sm">
                            Confirm Payment
                        </button>
                    </div>
                </div>

                <!-- Payment Success (Hidden initially) -->
                <div id="payment-success"
                    class="max-w-md mx-auto bg-white rounded-lg shadow-lg p-3 sm:p-5 mt-4 sm:mt-6 hidden">
                    <div class="text-center">
                        <div class="mx-auto mb-3 text-green-500">
                            <svg  class="h-12 w-12 mx-auto" fill="none"
                                viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                        </div>
                        <h2 class="text-lg sm:text-xl font-bold text-green-800 mb-1">Payment Successful!</h2>
                        <p class="text-gray-600 mb-4 text-sm">Your payment has been processed successfully.</p>
                        <div class="bg-gray-50 p-3 rounded-lg mb-4">
                            <!-- <p class="text-gray-700 mb-1 text-xs"><span class="font-semibold">Transaction ID:</span>
                                <span id="transaction-id">EP123456789</span></p> -->
                            <p class="text-gray-700 mb-1 text-xs"><span class="font-semibold">Amount Paid:</span> <span
                                    id="paid-amount" class="font-bold">0</span> PKR</p>
                            <p class="text-gray-700 text-xs"><span class="font-semibold">Date:</span> <span
                                    id="payment-date"></span></p>
                        </div>
                        <!--  -->
                        
                        <!-- Paid Fees History Section -->
                        <h3 class="text-xl font-semibold text-blue-800 mb-6" style="font-size: medium; text-align: left;">Now Paid Fees</h3>
                        <div class="overflow-x-auto mb-4 bg-gray-50 rounded-lg">
                            <div class="max-h-[500px] overflow-y-auto border border-gray-200 rounded-md">
                                <table class="min-w-full bg-white" id="now-paid-table">
                                    <thead  style="height: 40px;" class="sticky top-0 bg-gray-50 z-10">
                                        <tr>
                                            <th class="py-1 px-2 sm:px-4 border-b border-gray-200 bg-gray-50 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                                Record Id
                                            </th>
                                            <th class="py-1 px-2 sm:px-4 border-b border-gray-200 bg-gray-50 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                                Due Date
                                            </th>
                                            <th class="py-1 px-2 sm:px-4 border-b border-gray-200 bg-gray-50 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                                Purpose
                                            </th>
                                            <th class="py-1 px-2 sm:px-4 border-b border-gray-200 bg-gray-50 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                                Amount
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td class="py-2 px-2 sm:px-4 border-b border-gray-200 text-xs text-center">05-12-2022</td>
                                            <td class="py-2 px-2 sm:px-4 border-b border-gray-200 text-xs text-center">01-12-2022</td>
                                            <td class="py-2 px-2 sm:px-4 border-b border-gray-200 text-xs text-center">Monthly Fee (December)</td>
                                            <td class="py-2 px-2 sm:px-4 border-b border-gray-200 text-xs text-center">5,000</td>
                                        </tr>
                                        <tr>
                                            <td class="py-2 px-2 sm:px-4 border-b border-gray-200 text-xs text-center">10-11-2022</td>
                                            <td class="py-2 px-2 sm:px-4 border-b border-gray-200 text-xs text-center">05-11-2022</td>
                                            <td class="py-2 px-2 sm:px-4 border-b border-gray-200 text-xs text-center">Monthly Fee (November)</td>
                                            <td class="py-2 px-2 sm:px-4 border-b border-gray-200 text-xs text-center">5,000</td>
                                        </tr>
                                        <tr>
                                            <td class="py-2 px-2 sm:px-4 border-b border-gray-200 text-xs text-center">15-10-2022</td>
                                            <td class="py-2 px-2 sm:px-4 border-b border-gray-200 text-xs text-center">10-10-2022</td>
                                            <td class="py-2 px-2 sm:px-4 border-b border-gray-200 text-xs text-center">Exam Fee</td>
                                            <td class="py-2 px-2 sm:px-4 border-b border-gray-200 text-xs text-center">1,500</td>
                                        </tr>
                                        <tr>
                                            <td class="py-2 px-2 sm:px-4 border-b border-gray-200 text-xs text-center">03-10-2022</td>
                                            <td class="py-2 px-2 sm:px-4 border-b border-gray-200 text-xs text-center">01-10-2022</td>
                                            <td class="py-2 px-2 sm:px-4 border-b border-gray-200 text-xs text-center">Monthly Fee (October)</td>
                                            <td class="py-2 px-2 sm:px-4 border-b border-gray-200 text-xs text-center">5,000</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <!--  -->
                        <button id="back-to-home"
                            class="bg-blue-800 hover:bg-blue-900 text-white font-bold py-2 px-4 rounded-lg focus:outline-none focus:shadow-outline transition duration-300 w-full sm:w-auto text-sm">
                            Back to Home
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- About Page -->
        <div id="about" class="page">
            <div class="container mx-auto px-4 py-12">
                <!-- <h1 class="text-2xl font-bold text-left text-blue-800 mb-8">About Aziz-e-Millat School</h1> -->

                <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
                    <h2 style="font-size: medium;" class=" font-semibold text-blue-800 mb-4">Our Vision</h2>
                    <p class="text-gray-700 mb-4" style="font-size: small;">To be a leading educational institution that nurtures young minds and
                        shapes them into responsible, knowledgeable, and compassionate citizens who contribute
                        positively to society.</p>

                    <h2 style="font-size: medium;" class=" font-semibold text-blue-800 mb-4 mt-8">Our Mission</h2>
                    <p style="font-size: small;" class="text-gray-700 mb-4">To provide quality education in a safe, supportive, and stimulating
                        environment that promotes intellectual curiosity, critical thinking, and moral values.</p>

                    <h2 style="font-size: medium;" class=" font-semibold text-blue-800 mb-4 mt-8">Our Values</h2>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="bg-blue-50 p-4 rounded-lg">
                            <h3 class="font-bold text-blue-800 mb-2">Excellence</h3>
                            <p style="font-size: small;" class="text-gray-700">Striving for the highest standards in academic and personal
                                development.</p>
                        </div>
                        <div class="bg-blue-50 p-4 rounded-lg">
                            <h3 class="font-bold text-blue-800 mb-2">Integrity</h3>
                            <p style="font-size: small;" class="text-gray-700">Upholding honesty, ethics, and moral principles in all actions.</p>
                        </div>
                        <div class="bg-blue-50 p-4 rounded-lg">
                            <h3 class="font-bold text-blue-800 mb-2">Respect</h3>
                            <p style="font-size: small;" class="text-gray-700">Fostering mutual respect, tolerance, and appreciation for
                                diversity.</p>
                        </div>
                    </div>
                </div>

                
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <h2 style="font-size: medium;" class=" font-semibold text-blue-800 mb-6">Contact Information</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <div>
                            <h3 class="text-xl font-medium text-blue-800 mb-4">Address</h3>
                            <p style="font-size: small;" class="text-gray-700 mb-2">Sector 15-b,</p>
                            <p style="font-size: small;" class="text-gray-700 mb-2">Orangi Town,</p>
                            <p style="font-size: small;" class="text-gray-700 mb-6">Karachi, Pakistan</p>

                            <h3 class="text-xl font-medium text-blue-800 mb-4">Contact Details</h3>
                            <p style="font-size: small;" class="text-gray-700 mb-2"><span class="font-semibold">Phone:</span> +92-42-1234567</p>
                            <p style="font-size: small;" class="text-gray-700 mb-2"><span class="font-semibold">Email:</span>
                                info@aziz-e-millat.edu.pk</p>
                            <p style="font-size: small;" class="text-gray-700 mb-2"><span class="font-semibold">Office Hours:</span> Monday to
                                Friday, 8:00 AM - 3:00 PM</p>
                        </div>
                        <div class="bg-gray-100 p-4 rounded-lg h-64 overflow-hidden">
                            <iframe
                                class="w-full h-full rounded-lg border-0"
                                loading="lazy"
                                allowfullscreen
                                referrerpolicy="no-referrer-when-downgrade"
                                src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d1317.677380043579!2d67.00159052493304!3d24.951458177595523!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3eb3401e80fd4523%3A0xd61236aa4d68907b!2sAziz-e-Millat%20High%20School!5e1!3m2!1sen!2s!4v1752776021885!5m2!1sen!2s"
                            ></iframe>
                        </div>

                    </div>
                </div>
            </div>
        </div>

        <!-- Admin Dashboard Page -->
        <div id="dashboard" class="page"  style="padding: 20px;">
            <div class="container mx-auto px-4 py-8">
                <h1 class="text-3xl font-bold text-center text-blue-800 mb-8">School Admin Dashboard</h1>
                <h3 class="text-1xl font-bold text-center text-red-800 mb-8" id="dashboard-mobile-warning"></h3>

                <!-- Admin Login Form (would be shown first in real implementation) -->
                <div id="admin-login" class="max-w-md mx-auto bg-white rounded-lg shadow-lg p-6 mb-8 hidden">
                    <h2 class="text-xl font-semibold mb-4 text-blue-800">Admin Login</h2>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="username">
                            Username
                        </label>
                        <input id="username" type="text"
                            class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                            placeholder="Enter Username">
                    </div>
                    <div class="mb-6">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="admin-password">
                            Password
                        </label>
                        <input id="admin-password" type="password"
                            class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                            placeholder="Enter Password">
                    </div>
                    <div class="flex items-center justify-center">
                        <button id="admin-login-btn"
                            class="bg-blue-800 hover:bg-blue-900 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline transition duration-300">
                            Login
                        </button>
                    </div>
                </div>

                <!-- Dashboard Content -->
                <div id="dashboard-content">
                    <!-- Dashboard Stats -->
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-8">
                        <div class="bg-white rounded-lg shadow p-6">
                            <div class="flex items-center">
                                <div class="p-3 rounded-full bg-blue-100 text-blue-800 mr-4">
                                    <svg  class="h-6 w-6" fill="none"
                                        viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z" />
                                    </svg>
                                </div>
                                <div>
                                    <p class="text-gray-500 text-sm">Total Students</p>
                                    <p class="text-2xl font-bold text-gray-800">1,248</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg shadow p-6">
                            <div class="flex items-center">
                                <div class="p-3 rounded-full bg-green-100 text-green-800 mr-4">
                                    <svg  class="h-6 w-6" fill="none"
                                        viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                    </svg>
                                </div>
                                <div>
                                    <p class="text-gray-500 text-sm">Fees Collected (Month)</p>
                                    <p class="text-2xl font-bold text-gray-800">₨ 1.2M</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg shadow p-6">
                            <div class="flex items-center">
                                <div class="p-3 rounded-full bg-yellow-100 text-yellow-800 mr-4">
                                    <svg  class="h-6 w-6" fill="none"
                                        viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                                    </svg>
                                </div>
                                <div>
                                    <p class="text-gray-500 text-sm">Pending Payments</p>
                                    <p class="text-2xl font-bold text-gray-800">₨ 450K</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg shadow p-6">
                            <div class="flex items-center">
                                <div class="p-3 rounded-full bg-purple-100 text-purple-800 mr-4">
                                    <svg  class="h-6 w-6" fill="none"
                                        viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
                                    </svg>
                                </div>
                                <div>
                                    <p class="text-gray-500 text-sm">Total Classes</p>
                                    <p class="text-2xl font-bold text-gray-800">11</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Monthly Income Section -->
                    <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
                        <h2 class="text-xl font-semibold text-blue-800 mb-6">Detailed Monthly Income</h2>

                        <div class="overflow-x-auto">
                            <div class="max-h-[500px] overflow-y-auto border border-gray-200 rounded-md">
                                <table class="min-w-full bg-white" id="monthly-income-table">
                                    <thead  style="height: 40px;" class="sticky top-0 bg-blue-50 z-10">
                                        <tr>
                                            <th
                                                class="py-2 px-4 border-b border-gray-200 bg-gray-50 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                                Month</th>
                                            <th
                                                class="py-2 px-4 border-b border-gray-200 bg-gray-50 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                                Total Students</th>
                                            <th
                                                class="py-2 px-4 border-b border-gray-200 bg-gray-50 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                                Fees Collected (PKR)</th>
                                            <th
                                                class="py-2 px-4 border-b border-gray-200 bg-gray-50 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                                Pending Fees (PKR)</th>
                                            <th
                                                class="py-2 px-4 border-b border-gray-200 bg-gray-50 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                                Collection Rate</th>
                                                
                                        </tr>
                                    </thead>
                                    <tbody class="[&>tr:nth-child(odd)]:bg-white [&>tr:nth-child(even)]:bg-blue-50">
                                        <tr>
                                            <td colspan="5"
                                                class="py-4 px-4 border-b border-gray-200 text-center text-gray-500">
                                                <div id="monthly-income-loading" class="flex justify-center items-center py-8">
                                                    <svg class="animate-spin h-6 w-6 text-blue-800 mr-2"  fill="none" viewBox="0 0 24 24">
                                                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v8z"></path>
                                                    </svg>
                                                    <span class="text-blue-800 font-medium">Loading monthly income data...</span>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <br>
                    <br>

                    <!-- Monthly Data Setting -->
                    <div class="bg-white rounded-lg shadow-lg p-6 mb-8" style="padding: 20px;">
                        <h2 class="text-xl font-semibold text-blue-800 mb-6">Monthly Fees Setting</h3>
                            
                        <div class="overflow-x-auto">
                            <div class="max-h-[500px] overflow-y-auto border border-gray-200 rounded-md">
                            <table class="min-w-full bg-white" id="month-fees-setting-table">
                                <thead  style="height: 40px;" class="sticky top-0 bg-gray-50 z-10">
                                <tr>
                                    <th
                                        class="py-1 px-1 sm:px-3 border-b border-gray-200 bg-gray-50 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                        Class</th>
                                    <th
                                        class="py-1 px-1 sm:px-3 border-b border-gray-200 bg-gray-50 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                        Month End Day (for Fees Distribute)</th>
                                    <th
                                        class="py-1 px-1 sm:px-3 border-b border-gray-200 bg-gray-50 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                        Amount</th>
                                </tr>
                            </thead>
                            
                            <tbody>
                                <!-- Class 1 -->
                                <tr>
                                    <td class="py-2 px-1 sm:px-3 border-b border-gray-200">
                                        <input id="monthly-1-fees-Class" type="text" class="shadow appearance-none border rounded w-full py-2 pl-2 pr-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                                        placeholder="Class...">
                                    </td>
                                    <td class="py-2 px-1 sm:px-3 border-b border-gray-200">
                                        <input id="monthly-1-fees-DueDate" type="text" class="shadow appearance-none border rounded w-full py-2 pl-2 pr-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                                        placeholder="Month End Day...">
                                    </td>
                                    <td class="py-2 px-1 sm:px-3 border-b border-gray-200">
                                        <input id="monthly-1-fees-Ammount" type="text" class="shadow appearance-none border rounded w-full py-2 pl-2 pr-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                                        placeholder="Ammount...">
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        </div>
                        
                        <div style="height: 20px;"></div>
                        <button id="save-monthly-set-btn"
                            class="bg-blue-800 hover:bg-blue-900 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline transition duration-300 flex items-center justify-center"
                            style="font-size: 100%;">
                            Save Setting
                            <svg  class="h
                                -5 w-5 ml-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M12 6v6m0 0v6m0-6h6m-6 0H6" />   
                            </svg>
                        </button>
                        <div style="height: 10px;"></div>
                        <button id="revert-monthly-set-btn"
                            class="bg-blue-800 hover:bg-blue-900 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline transition duration-300 flex items-center justify-center"
                            style="font-size: 100%;">
                            Revert / Refresh Setting
                            <svg  class="h
                                -5 w-5 ml-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M12 6v6m0 0v6m0-6h6m-6 0H6" />   
                            </svg>
                        </button>
                    </div>
                    </div>
                    
                    <br>
                    <br>
                    
                    <!-- Data Setting -->
                    <div class="bg-white rounded-lg shadow-lg p-6 mb-8" style="padding: 20px;">
                        <h2 class="text-xl font-semibold text-blue-800 mb-6">New Custome Fees</h3>
                        <table class="min-w-full bg-white" id="new-fees-setting-table">
                            <thead  style="height: 40px;">
                                <tr>
                                    <th
                                        class="py-1 px-1 sm:px-3 border-b border-gray-200 bg-gray-50 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                        Class</th>
                                    <th
                                        class="py-1 px-1 sm:px-3 border-b border-gray-200 bg-gray-50 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                        Due Date</th>
                                    <th
                                        class="py-1 px-1 sm:px-3 border-b border-gray-200 bg-gray-50 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                        Purpose</th>
                                    <th
                                        class="py-1 px-1 sm:px-3 border-b border-gray-200 bg-gray-50 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                        Amount</th>
                                </tr>
                            </thead>
                            
                            <tbody>
                                <tr>
                                    <td class="py-2 px-1 sm:px-3 border-b border-gray-200">
                                        <input id="custome-fees-Class" type="text"
                                        class="shadow appearance-none border rounded w-full py-2 pl-2 pr-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                                        placeholder="Class...">
                                    </td>
                                    <td class="py-2 px-1 sm:px-3 border-b border-gray-200">
                                        <input id="custome-fees-DueDate" type="date"
                                        class="shadow appearance-none border rounded w-full py-2 pl-2 pr-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                                        placeholder="Due Date...">
                                    </td>
                                    <td class="py-2 px-1 sm:px-3 border-b border-gray-200">
                                        <input id="custome-fees-Purpose" type="text"
                                        class="shadow appearance-none border rounded w-full py-2 pl-2 pr-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                                        placeholder="Purpose...">
                                    </td>
                                    <td class="py-2 px-1 sm:px-3 border-b border-gray-200">
                                        <input id="custome-fees-Ammount" type="text"
                                        class="shadow appearance-none border rounded w-full py-2 pl-2 pr-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                                        placeholder="Ammount...">
                                    </td>
                                </tr>
                                <tr>
                                    <td class="py-2 px-1 sm:px-3 border-b border-gray-200"></td>
                                    <td class="py-2 px-1 sm:px-3 border-b border-gray-200"></td>
                                    <td class="py-2 px-1 sm:px-3 border-b border-gray-200"></td>
                                    <td class="py-2 px-1 sm:px-3 border-b border-gray-200">
                                        
                                        <button id="add-new-fees-btn"
                                            class="bg-blue-800 hover:bg-blue-900 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline transition duration-300 flex items-center justify-center"
                                            style="font-size: 100%;">
                                            Add New Custome Fees
                                            <svg  class="h
                                                -5 w-5 ml-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                    d="M12 6v6m0 0v6m0-6h6m-6 0H6" />   
                                            </svg>
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="py-2 px-1 sm:px-3 border-b border-gray-200"></td>
                                    <td class="py-2 px-1 sm:px-3 border-b border-gray-200"></td>
                                    <td class="py-2 px-1 sm:px-3 border-b border-gray-200"></td>
                                    <td class="py-2 px-1 sm:px-3 border-b border-gray-200">
                                        
                                        <button id="remove-all-new-fees-btn"
                                            class="bg-red-800 hover:bg-blue-900 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline transition duration-300 flex items-center justify-center"
                                            style="font-size: 100%;">
                                            Remove All Custome Fees
                                            <svg  class="h
                                                -5 w-5 ml-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                    d="M12 6v6m0 0v6m0-6h6m-6 0H6" />   
                                            </svg>
                                        </button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <br>
                    <br>
                                        
                    <!-- All Custome Fees -->
                    <div class="bg-white rounded-lg shadow-lg p-6 mb-8" style="padding: 20px;">
                        <h2 class="text-xl font-semibold text-blue-800 mb-6">New Custome Fees</h3>
                        <div class="max-h-[500px] overflow-y-auto border border-gray-200 rounded-md">
                            <table class="min-w-full bg-white"  id="new-fees-table">
                                <thead  style="height: 40px;" class="sticky top-0 bg-gray-50 z-10">
                                    <tr>
                                        <th
                                            class="py-1 px-1 sm:px-3 border-b border-gray-200 bg-gray-50 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                            Record Id</th>
                                        <th
                                            class="py-1 px-1 sm:px-3 border-b border-gray-200 bg-gray-50 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                            Class</th>
                                        <th
                                            class="py-1 px-1 sm:px-3 border-b border-gray-200 bg-gray-50 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                            Due Date</th>
                                        <th
                                            class="py-1 px-1 sm:px-3 border-b border-gray-200 bg-gray-50 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                            Purpose</th>
                                        <th
                                            class="py-1 px-1 sm:px-3 border-b border-gray-200 bg-gray-50 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                            Amount</th>
                                        <th
                                            class="py-1 px-1 sm:px-3 border-b border-gray-200 bg-gray-50 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                            Buttons</th>
                                    </tr>
                                </thead>
                                
                                    <tbody class="[&>tr:nth-child(odd)]:bg-white [&>tr:nth-child(even)]:bg-gray-200">
                                        <tr>
                                            <td colspan="5"
                                                class="py-4 px-4 border-b border-gray-200 text-center text-gray-500">
                                                <div id="monthly-income-loading" class="flex justify-center items-center py-8">
                                                    <svg class="animate-spin h-6 w-6 text-blue-800 mr-2"  fill="none" viewBox="0 0 24 24">
                                                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v8z"></path>
                                                    </svg>
                                                    <span class="text-blue-800 font-medium">Loading monthly income data...</span>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                            </table>
                        </div>
                    </div>

                    <br>
                    
                    <!-- Search and Add Student -->
                    <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
                        <div class="flex flex-col md:flex-row justify-between items-center mb-6">
                            <h2 class="text-xl font-semibold text-blue-800 mb-4 md:mb-0">Student Management</h2>
                            <div class="flex flex-col sm:flex-row w-full md:w-auto space-y-4 sm:space-y-0 sm:space-x-4">
                                <!-- Name -->
                                <div class="relative">
                                    <input id="search-student-name" type="text"
                                        class="shadow appearance-none border rounded w-full py-2 pl-10 pr-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                                        placeholder="Search by Name...">
                                    <div class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none">
                                        <svg  class="h-5 w-5 text-gray-400"
                                            fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                                        </svg>
                                    </div>
                                </div>
                                <!-- Class -->
                                <div class="relative">
                                    <input id="search-student-class" type="text"
                                        class="shadow appearance-none border rounded w-full py-2 pl-10 pr-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                                        placeholder="Search by Class...">
                                    <div class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none">
                                        <svg  class="h-5 w-5 text-gray-400"
                                            fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                                        </svg>
                                    </div>
                                </div>
                                <!-- Roll Number -->
                                <div class="relative">
                                    <input id="search-student-roll" type="text"
                                        class="shadow appearance-none border rounded w-full py-2 pl-10 pr-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                                        placeholder="Search by Roll-Number...">
                                    <div class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none">
                                        <svg  class="h-5 w-5 text-gray-400"
                                            fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                                        </svg>
                                    </div>
                                </div>

                                <button id="add-student-btn"
                                    class="bg-blue-800 hover:bg-blue-900 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline transition duration-300 flex items-center justify-center">
                                    <svg  class="h-5 w-5 mr-2" fill="none"
                                        viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
                                    </svg>
                                    Add New Student
                                </button>
                            </div>
                        </div>

                        <!-- Student Table -->
                        <div class="overflow-x-auto">
                            <div class="max-h-[500px] overflow-y-auto border border-gray-200 rounded-md">
                                <table class="min-w-full bg-white student-management-table">
                                    <thead  style="height: 40px;" class="sticky top-0 bg-gray-50 z-10">
                                    <tr>
                                        <th
                                            class="py-2 px-4 border-b border-gray-200 bg-gray-50 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                            Name</th>
                                        <th
                                            class="py-2 px-4 border-b border-gray-200 bg-gray-50 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                            Class</th>
                                        <th
                                            class="py-2 px-4 border-b border-gray-200 bg-gray-50 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                            Roll No</th>
                                        <th
                                            class="py-2 px-4 border-b border-gray-200 bg-gray-50 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                            Parent</th>
                                        <th
                                            class="py-2 px-4 border-b border-gray-200 bg-gray-50 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                            Contact</th>
                                        <th
                                            class="py-2 px-4 border-b border-gray-200 bg-gray-50 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                            Pending</th>
                                        <th
                                            class="py-2 px-4 border-b border-gray-200 bg-gray-50 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                            Paid</th>
                                        <th
                                            class="py-2 px-4 border-b border-gray-200 bg-gray-50 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                            Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="student-records" class="[&>tr:nth-child(odd)]:bg-white [&>tr:nth-child(even)]:bg-gray-200">
                                    <tr>
                                        <td colspan="5"
                                            class="py-4 px-4 border-b border-gray-200 text-center text-gray-500">
                                            <div id="monthly-income-loading" class="flex justify-center items-center py-8">
                                                <svg class="animate-spin h-6 w-6 text-blue-800 mr-2"  fill="none" viewBox="0 0 24 24">
                                                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v8z"></path>
                                                </svg>
                                                <span class="text-blue-800 font-medium">Loading monthly income data...</span>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        </div>
                    </div>
                    
                    <button id="admin-logout-btn"
                        class="bg-red-800 hover:bg-red-900 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline transition duration-300 flex items-center justify-center"
                        style="font-size: 100%;">
                        Logout Admin Access
                    </button>

                    <!-- View Student Modal (Now scrollable on smaller screens) -->
                    <div id="view-student-modal"
                        class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50 p-4 overflow-y-auto hidden">
                        <div class="bg-white rounded-lg shadow-lg w-full max-w-3xl max-h-[90vh] overflow-y-auto p-6">
                            <!-- Header -->
                            <div class="flex justify-between items-center mb-4 bg-white z-20">
                                <h3 class="text-xl font-semibold text-blue-800">Student Details</h3>
                                <button class="close-modal text-gray-500 hover:text-gray-700">
                                    <svg  class="h-6 w-6" fill="none"
                                        viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M6 18L18 6M6 6l12 12" />
                                    </svg>
                                </button>
                            </div>


                            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                                <div class="md:col-span-1 flex flex-col items-center">
                                    <div
                                        class="w-32 h-32 bg-gray-200 rounded-full mb-4 flex items-center justify-center">
                                        <svg class="w-20 h-20 text-gray-400" 
                                            fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1"
                                                d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                                        </svg>
                                    </div>
                                    <h4 class="text-lg font-semibold" id="view-student-name">Ahmed Khan</h4>
                                    <p class="text-gray-600" id="view-student-id">ID: ST-2023-001</p>
                                </div>

                                <div class="md:col-span-2">
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div>
                                            <p class="text-sm text-gray-500">Class</p>
                                            <p class="font-medium" id="view-student-class">Class 8</p>
                                        </div>
                                        <div>
                                            <p class="text-sm text-gray-500">Roll Number</p>
                                            <p class="font-medium" id="view-student-roll">123</p>
                                        </div>
                                        <div>
                                            <p class="text-sm text-gray-500">Parent Name</p>
                                            <p class="font-medium" id="view-student-parent">Imran Khan</p>
                                        </div>
                                        <div>
                                            <p class="text-sm text-gray-500">Contact Number</p>
                                            <p class="font-medium" id="view-student-contact">0300-1234567</p>
                                        </div>
                                        <div>
                                            <p class="text-sm text-gray-500">Address</p>
                                            <p class="font-medium" id="view-student-address">123 Main Street, Model
                                                Town, Lahore</p>
                                        </div>
                                        <div>
                                            <p class="text-sm text-gray-500">Admission Date</p>
                                            <p class="font-medium" id="view-student-admission">01-04-2020</p>
                                        </div>
                                    </div>

                                    <div class="mt-6">
                                        <h4 class="font-semibold text-blue-800 mb-2">Fee Summary</h4>
                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                            <div class="bg-green-50 p-3 rounded-lg">
                                                <p class="text-sm text-gray-500">Total Paid</p>
                                                <p class="font-semibold text-green-700">₨ 45,000</p>
                                            </div>
                                            <div class="bg-yellow-50 p-3 rounded-lg">
                                                <p class="text-sm text-gray-500">Pending</p>
                                                <p class="font-semibold text-yellow-700">₨ 14,000</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="mt-6">
                                <h4 class="font-semibold text-blue-800 mb-2">All Fee Transactions</h4>
                                <div class="overflow-x-auto">
                                    <div class="max-h-[500px] overflow-y-auto border border-gray-200 rounded-md">
                                        <table class="min-w-full bg-white">
                                            <thead  style="height: 40px;" class="sticky top-0 bg-gray-50 z-10">
                                                <tr>
                                                    <th
                                                        class="py-2 px-4 border-b border-gray-200 bg-gray-50 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                                        Record Id</th>
                                                    <th
                                                        class="py-2 px-4 border-b border-gray-200 bg-gray-50 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                                        Pay Date</th>
                                                    <th
                                                        class="py-2 px-4 border-b border-gray-200 bg-gray-50 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                                        Due Date</th>
                                                    <th
                                                        class="py-2 px-4 border-b border-gray-200 bg-gray-50 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                                        Purpose</th>
                                                    <th
                                                        class="py-2 px-4 border-b border-gray-200 bg-gray-50 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                                        Amount</th>
                                                    <th
                                                        class="py-2 px-4 border-b border-gray-200 bg-gray-50 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                                        Status</th>
                                                </tr>
                                            </thead>
                                            <tbody class="[&>tr:nth-child(odd)]:bg-white [&>tr:nth-child(even)]:bg-gray-200">
                                                <tr>
                                                    <td class="py-2 px-4 border-b border-gray-200">05-05-2023</td>
                                                    <td class="py-2 px-4 border-b border-gray-200">01-05-2023</td>
                                                    <td class="py-2 px-4 border-b border-gray-200">Monthly Fee (May)</td>
                                                    <td class="py-2 px-4 border-b border-gray-200">₨ 5,000</td>
                                                    <td class="py-2 px-4 border-b border-gray-200"><span
                                                            class="px-2 py-1 text-xs rounded-full bg-green-100 text-green-800">Paid</span>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td class="py-2 px-4 border-b border-gray-200">10-04-2023</td>
                                                    <td class="py-2 px-4 border-b border-gray-200">01-04-2023</td>
                                                    <td class="py-2 px-4 border-b border-gray-200">Monthly Fee (April)</td>
                                                    <td class="py-2 px-4 border-b border-gray-200">₨ 5,000</td>
                                                    <td class="py-2 px-4 border-b border-gray-200"><span
                                                            class="px-2 py-1 text-xs rounded-full bg-green-100 text-green-800">Paid</span>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td class="py-2 px-4 border-b border-gray-200">15-03-2023</td>
                                                    <td class="py-2 px-4 border-b border-gray-200">10-03-2023</td>
                                                    <td class="py-2 px-4 border-b border-gray-200">Exam Fee</td>
                                                    <td class="py-2 px-4 border-b border-gray-200">₨ 1,500</td>
                                                    <td class="py-2 px-4 border-b border-gray-200"><span
                                                            class="px-2 py-1 text-xs rounded-full bg-green-100 text-green-800">Paid</span>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>

                            <div class="flex items-center justify-end mt-6">
                                <button
                                    class="close-modal bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline transition duration-300">
                                    Close
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Edit Student Modal (Hidden initially) -->
                    <div id="edit-student-modal"
                        class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center hidden z-50">
                        <div class="bg-white rounded-lg shadow-lg p-6 w-full max-w-md">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="text-xl font-semibold text-blue-800">Edit Student</h3>
                                <button class="close-modal text-gray-500 hover:text-gray-700">
                                    <svg  class="h-6 w-6" fill="none"
                                        viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M6 18L18 6M6 6l12 12" />
                                    </svg>
                                </button>
                            </div>

                            <form id="edit-student-form">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                    <div>
                                        <label class="block text-gray-700 text-sm font-bold mb-2" for="edit-name">
                                            Student Name
                                        </label>
                                        <input id="edit-name" type="text"
                                            class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                                            value="Ahmed Khan">
                                    </div>
                                    <div>
                                        <label class="block text-gray-700 text-sm font-bold mb-2" for="edit-class">
                                            Class
                                        </label>
                                        <div class="relative">
                                            <select id="edit-class"
                                                class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline pr-8">
                                                <option value="">Select Class</option>
                                                <option value="0">Montessori</option>
                                                <option value="1">Class 1</option>
                                                <option value="2">Class 2</option>
                                                <option value="3">Class 3</option>
                                                <option value="4">Class 4</option>
                                                <option value="5">Class 5</option>
                                                <option value="6">Class 6</option>
                                                <option value="7">Class 7</option>
                                                <option value="8" selected>Class 8</option>
                                                <option value="9">Class 9</option>
                                                <option value="10">Class 10</option>
                                            </select>
                                            <div
                                                class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700">
                                                <svg class="fill-current h-4 w-4" 
                                                    viewBox="0 0 20 20">
                                                    <path
                                                        d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z" />
                                                </svg>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                    <div>
                                        <label class="block text-gray-700 text-sm font-bold mb-2" for="edit-roll">
                                            Roll Number
                                        </label>
                                        <input id="edit-roll" type="text"
                                            class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                                            value="123">
                                    </div>
                                    <div>
                                        <label class="block text-gray-700 text-sm font-bold mb-2" for="edit-parent">
                                            Parent Name
                                        </label>
                                        <input id="edit-parent" type="text"
                                            class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                                            value="Imran Khan">
                                    </div>
                                </div>

                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                    <div>
                                        <label class="block text-gray-700 text-sm font-bold mb-2" for="edit-contact">
                                            Contact Number
                                        </label>
                                        <input id="edit-contact" type="text"
                                            class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                                            value="0300-1234567">
                                    </div>
                                    <div>
                                        <label class="block text-gray-700 text-sm font-bold mb-2" for="edit-address">
                                            Address
                                        </label>
                                        <input id="edit-address" type="text"
                                            class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                                            value="123 Main Street, Model Town, Lahore">
                                    </div>
                                </div>

                                <div class="flex items-center justify-end mt-6">
                                    <button type="button"
                                        class="close-modal bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline transition duration-300 mr-4">
                                        Cancel
                                    </button>
                                    <button type="submit"
                                        class="bg-blue-800 hover:bg-blue-900 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline transition duration-300">
                                        Save Changes
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>

                    <!-- Add Student Modal (Hidden initially) -->
                    <div id="add-student-modal"
                        class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center hidden z-50">
                        <div class="bg-white rounded-lg shadow-lg p-6 w-full max-w-md">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="text-xl font-semibold text-blue-800">Add New Student</h3>
                                <button id="close-modal" class="text-gray-500 hover:text-gray-700">
                                    <svg  class="h-6 w-6" fill="none"
                                        viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M6 18L18 6M6 6l12 12" />
                                    </svg>
                                </button>
                            </div>

                            <form id="add-student-form">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                    <div>
                                        <label class="block text-gray-700 text-sm font-bold mb-2" for="student-name">
                                            Student Name
                                        </label>
                                        <input id="addNew_User-student-name" type="text"
                                            class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                                    </div>
                                    <div>
                                        <label class="block text-gray-700 text-sm font-bold mb-2"
                                            for="student-class-select">
                                            Class
                                        </label>
                                        <div class="relative">
                                            <select id="addNew_User-student-class-select"
                                                class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline pr-8">
                                                <option value="">Select Class</option>
                                                <option value="0">Montessori</option>
                                                <option value="1">Class 1</option>
                                                <option value="2">Class 2</option>
                                                <option value="3">Class 3</option>
                                                <option value="4">Class 4</option>
                                                <option value="5">Class 5</option>
                                                <option value="6">Class 6</option>
                                                <option value="7">Class 7</option>
                                                <option value="8">Class 8</option>
                                                <option value="9">Class 9</option>
                                                <option value="10">Class 10</option>
                                            </select>
                                            <div
                                                class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700">
                                                <svg class="fill-current h-4 w-4" 
                                                    viewBox="0 0 20 20">
                                                    <path
                                                        d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z" />
                                                </svg>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                    <div>
                                        <label class="block text-gray-700 text-sm font-bold mb-2" for="student-roll">
                                            Roll Number
                                        </label>
                                        <input id="addNew_User-student-roll" type="text"
                                            class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                                    </div>
                                    <div>
                                        <label class="block text-gray-700 text-sm font-bold mb-2" for="parent-name">
                                            Parent Name
                                        </label>
                                        <input id="addNew_User-parent-name" type="text"
                                            class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                                    </div>
                                </div>

                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                    <div>
                                        <label class="block text-gray-700 text-sm font-bold mb-2" for="contact-number">
                                            Contact Number
                                        </label>
                                        <input id="addNew_User-contact-number" type="text"
                                            class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                                    </div>
                                    <div>
                                        <label class="block text-gray-700 text-sm font-bold mb-2" for="address">
                                            Address
                                        </label>
                                        <input id="addNew_User-address" type="text"
                                            class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                                    </div>
                                </div>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                    <div>
                                        <label class="block text-gray-700 text-sm font-bold mb-2">
                                            Password was empty Student can set Password
                                        </label>
                                    </div>
                                </div>

                                <div class="flex items-center justify-end mt-6">
                                    <button type="button" id="cancel-add"
                                        class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline transition duration-300 mr-4">
                                        Cancel
                                    </button>
                                    <button type="submit"
                                        class="bg-blue-800 hover:bg-blue-900 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline transition duration-300">
                                        Add Student
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="bg-blue-900 text-white py-6 sm:py-8 mt-auto">
            <div class="container mx-auto px-4">
                <div class="flex flex-wrap justify-between">
                    <div class="w-full md:w-1/3 mb-6 md:mb-0">
                        <h3 class="text-lg sm:text-xl font-bold mb-3 sm:mb-4" style="font-size: medium;">Aziz-e-Millat School</h3>
                        <p class="mb-4 text-sm sm:text-base" style="font-size: small;">Providing quality education from Montessori to Matric since
                            1995.</p>
                        <div class="flex space-x-4">
                            <a href="#" class="text-white hover:text-blue-300">
                                <svg class="h-5 w-5 sm:h-6 sm:w-6" fill="currentColor" viewBox="0 0 24 24">
                                    <path
                                        d="M22 12c0-5.523-4.477-10-10-10S2 6.477 2 12c0 4.991 3.657 9.128 8.438 9.878v-6.987h-2.54V12h2.54V9.797c0-2.506 1.492-3.89 3.777-3.89 1.094 0 2.238.195 2.238.195v2.46h-1.26c-1.243 0-1.63.771-1.63 1.562V12h2.773l-.443 2.89h-2.33v6.988C18.343 21.128 22 16.991 22 12z">
                                    </path>
                                </svg>
                            </a>
                            <a href="#" class="text-white hover:text-blue-300">
                                <svg class="h-5 w-5 sm:h-6 sm:w-6" fill="currentColor" viewBox="0 0 24 24">
                                    <path
                                        d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zM12 0C8.741 0 8.333.014 7.053.072 2.695.272.273 2.69.073 7.052.014 8.333 0 8.741 0 12c0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98C8.333 23.986 8.741 24 12 24c3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98C15.668.014 15.259 0 12 0zm0 5.838a6.162 6.162 0 100 12.324 6.162 6.162 0 000-12.324zM12 16a4 4 0 110-8 4 4 0 010 8zm6.406-11.845a1.44 1.44 0 100 2.881 1.44 1.44 0 000-2.881z">
                                    </path>
                                </svg>
                            </a>
                            <a href="#" class="text-white hover:text-blue-300">
                                <svg class="h-5 w-5 sm:h-6 sm:w-6" fill="currentColor" viewBox="0 0 24 24">
                                    <path
                                        d="M8.29 20.251c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0022 5.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.072 4.072 0 012.8 9.713v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 012 18.407a11.616 11.616 0 006.29 1.84">
                                    </path>
                                </svg>
                            </a>
                        </div>
                    </div>
                    <div class="w-full md:w-1/3 mb-6 md:mb-0">
                        <h3 class="text-lg sm:text-xl font-bold mb-3 sm:mb-4" style="font-size: medium;">Quick Links</h3>
                        <ul class="space-y-1 sm:space-y-2 text-sm sm:text-base">
                            <li><a href="#" class="nav-link block py-2 lg:inline-block lg:mt-0 text-blue-200 hover:text-white" style="font-size: small; margin-top: -15px;" data-page="home" >Home</a></li>
                            <li><a href="#"  class="nav-link block py-2 lg:inline-block lg:mt-0 text-blue-200 hover:text-white" style="font-size: small; margin-top: -15px;" data-page="pay-fees">Pay Fees</a></li>
                            <li><a href="#" class="nav-link block py-2 lg:inline-block lg:mt-0 text-blue-200 hover:text-white" style="font-size: small; margin-top: -15px;" data-page="about" >About Us</a></li>
                            <!-- <li><a href="#" class="text-blue-200 hover:text-white">Contact</a></li> -->
                            <!-- <li><a href="#" class="text-blue-200 hover:text-white">Admissions</a></li> -->
                        </ul>
                    </div>
                    <div class="w-full md:w-1/3">
                        <h3 class="text-lg sm:text-xl font-bold mb-3 sm:mb-4" style="font-size: medium;">Contact Us</h3>
                        <ul class="space-y-2 text-sm sm:text-base">
                            <li class="flex items-start">
                                <svg class="h-5 w-5 sm:h-6 sm:w-6 mr-2 text-blue-300 flex-shrink-0" fill="none"
                                    viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                                </svg>
                                <span style="font-size: small;">123 Education Road, Model Town, Lahore</span>
                            </li>
                            <li class="flex items-start">
                                <svg class="h-5 w-5 sm:h-6 sm:w-6 mr-2 text-blue-300 flex-shrink-0" fill="none"
                                    viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
                                </svg>
                                <span style="font-size: small;">+92-42-1234567</span>
                            </li>
                            <li class="flex items-start">
                                <svg class="h-5 w-5 sm:h-6 sm:w-6 mr-2 text-blue-300 flex-shrink-0" fill="none"
                                    viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                                </svg>
                                <span style="font-size: small;">info@aziz-e-millat.edu.pk</span>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="border-t border-blue-800 mt-6 sm:mt-8 pt-4 sm:pt-6 text-center text-xs sm:text-sm">
                    <p>&copy; 2023 Aziz-e-Millat School and Your Student. All rights reserved.</p>
                </div>
            </div>
        </footer>

    </main>


    <script>
        
        // Navigation
        document.addEventListener('DOMContentLoaded', function () {
            
            function isMobileDevice() {
                return /Mobi|Android|iPhone|iPad|iPod|BlackBerry|Windows Phone/i.test(navigator.userAgent);
            }
            // Scroll to top of the page
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
            
            // Use the provided backend API endpoint
            const BASE_URL = 'https://salonking-backend.vercel.app';
            let currentAbortController = new AbortController();
            let student = null;
            let adminLogin_student = false;
            let selectedFees = [];
            
            // Mobile menu toggle
            const mobileMenuButton = document.getElementById('mobile-menu-button');
            const menu = document.getElementById('menu');

            mobileMenuButton.addEventListener('click', function () {
                menu.classList.toggle('hidden');
            });

            // Close mobile menu when clicking outside
            document.addEventListener('click', function (event) {
                const isClickInsideMenu = menu.contains(event.target);
                const isClickOnMenuButton = mobileMenuButton.contains(event.target);

                if (!isClickInsideMenu && !isClickOnMenuButton && !menu.classList.contains('hidden')) {
                    menu.classList.add('hidden');
                }
            });

            // Page navigation
            const navLinks = document.querySelectorAll('.nav-link');
            const pages = document.querySelectorAll('.page');

            navLinks.forEach(link => {
                link.addEventListener('click', async function (e) {
                    e.preventDefault();
                    const targetPage = this.getAttribute('data-page');

                    // Hide all pages
                    pages.forEach(page => {
                        page.classList.remove('active-page');
                    });

                    // Show target page
                    document.getElementById(targetPage).classList.add('active-page');
                    console.log("Go next: "+ targetPage);

                    // Close mobile menu if open
                    if (!menu.classList.contains('hidden')) {
                        menu.classList.add('hidden');
                    }

                    if(targetPage == "dashboard"){
                        if( isMobileDevice()) {
                            document.getElementById('dashboard-mobile-warning').innerHTML = "Maddam please use PC/Laptop for dashboard";
                        } else {
                            document.getElementById('dashboard-mobile-warning').innerHTML = "";
                        }
                    }

                    if(targetPage == "pay-fees"){
                        const classValue = localStorage.getItem('class');
                        const rollNumber = localStorage.getItem('roll-number');
                        const password = localStorage.getItem('password');

                        if (classValue && rollNumber && password) {
                            try {
                                // Show loading state
                                loginBtn.disabled = true;
                                loginBtn.textContent = "Loading...";

                                // Fetch student data
                                let success = false;
                                const admin_password = localStorage.getItem('admin-password');
                                if(password == admin_password){
                                    success = await GetAdmin_LoginStudentData(classValue, rollNumber);
                                    if (success) {
                                        console.log("Admin login successful");
                                        adminLogin_student = true;
                                    }else{
                                        console.log("Not Admin login successful");
                                        adminLogin_student = false;
                                    }
                                }else{
                                    success = await Get_LoginStudentData(classValue, rollNumber , password);
                                    adminLogin_student = false;
                                }

                                if (success) {
                                    studentLogin.classList.add('hidden');
                                    feesDetails.classList.remove('hidden');

                                    // Update student info in the fees details section
                                    document.getElementById('student-name').textContent = student.name;
                                    document.getElementById('student-class').textContent = student.class === "0" ? "Montessori" : `${student.class}`;
                                    document.getElementById('student-roll').textContent = student.rollNumber;

                                    if(adminLogin_student){
                                        document.getElementById("pay-now-btn").innerText = "Continue as Admin | Without Online Payment";
                                    }
                                    // Update fees table with data from backend
                                    updateFeesTable(student.FeesHistory);

                                    console.log("Student data loaded:", student);
                                }
                            } catch (error) {
                                console.error("Login error:", error);
                            } finally {
                                // Reset button state
                                loginBtn.disabled = false;
                                loginBtn.textContent = "Login";
                            }
                            
                        }
                        // 
                    }
                    // Scroll to top of the page
                    window.scrollTo({
                        top: 0,
                        behavior: 'smooth'
                    });

                });
            });

            // Fee payment functionality
            const loginBtn = document.getElementById('login-btn');
            const studentLogin = document.getElementById('student-login');
            const feesDetails = document.getElementById('fees-details');

            // Function to fetch student data from API
            async function Get_LoginStudentData(classValue, rollNumber , password) {
                console.log("input password: "+password);
                currentAbortController = new AbortController();
                const Signal = currentAbortController.signal;
                try {
                    // Try API first
                    try {
                        const { signal } = Signal;
                        const response = await fetch(`${BASE_URL}/get_LoginStudentData`, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify({ class: classValue, rollNumber: rollNumber , password: password}),
                            signal
                        });
                        const result = await response.json();
                        if (result.error) {
                            throw new Error(result.error);
                        }

                        if (result.status === "success" && result.data) {
                            student = result.data;
                            console.log("Status: "+result.status+"Student data received from API:", student);
                            return true;
                        }
                    } catch (apiError) {
                        console.log("API fetch failed, using mock data instead:", apiError);
                    }

                    // If API fails, generate mock student data
                    console.log("Generating mock student data for login");

                    // Generate a mock student with the provided class and roll number
                    const mockStudent = generateMockStudent(classValue, rollNumber);
                    student = mockStudent;
                    console.log("Mock student data generated:", student);
                    return true;

                } catch (error) {
                    if (error.name === 'AbortError') {
                        console.log(`Fetch aborted`);
                        throw error;
                    }
                    console.error(`Error fetching student data:`, error);
                    showLoginError("Connection error. Please try again later.");
                    throw error;
                }
            }
            // Function to fetch student data from API
            async function GetAdmin_LoginStudentData(classValue, rollNumber) {
                
                const admin_password = localStorage.getItem('admin-password');
                if(admin_password == null || admin_password == ""){
                    return false;
                }
                const admin_username = localStorage.getItem('admin-userName');
                if(admin_username == null || admin_username == ""){
                    return false;
                }
                
                currentAbortController = new AbortController();
                const Signal = currentAbortController.signal;
                try {
                    // Try API first
                    try {
                        const { signal } = Signal;
                        const response = await fetch(`${BASE_URL}/getAdmin_LoginStudentData`, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify({ class: classValue, rollNumber: rollNumber , admin_username: admin_username , admin_password: admin_password}),
                            signal
                        });
                        const result = await response.json();
                        if (result.error) {
                            throw new Error(result.error);
                        }

                        if (result.status === "success" && result.data) {
                            student = result.data;
                            console.log("Status: "+result.status+"Student data received from API:", student);
                            return true;
                        }
                    } catch (apiError) {
                        console.log("API fetch failed, using mock data instead:", apiError);
                    }

                    // If API fails, generate mock student data
                    console.log("Generating mock student data for login");

                    // Generate a mock student with the provided class and roll number
                    const mockStudent = generateMockStudent(classValue, rollNumber);
                    student = mockStudent;
                    console.log("Mock student data generated:", student);
                    return true;

                } catch (error) {
                    if (error.name === 'AbortError') {
                        console.log(`Fetch aborted`);
                        throw error;
                    }
                    console.error(`Error fetching student data:`, error);
                    showLoginError("Connection error. Please try again later.");
                    throw error;
                }
            }

            // Generate a single mock student
            function generateMockStudent(classValue, rollNumber) {
                const names = ["Aliyaan Shahid", "Ahmed Raza", "Fatima Noor", "Sara Ahmed"];
                const parents = ["Shahid Khan", "Raza Ali", "Umer Farooq", "Kashif Mehmood"];
                const addresses = ["Lahore", "Karachi", "Islamabad", "Faisalabad"];
                const contacts = ["03001234567", "03111234567", "03211234567", "03331234567"];
                const purposes = ["January Fee", "February Fee", "March Fee"];

                // Generate fee history
                const feesHistory = [];

                // Generate 2-4 fee entries
                for (let i = 0; i < Math.floor(Math.random() * 3) + 2; i++) {
                    // Random dates
                    const today = new Date();
                    const dueDate = new Date(today);
                    dueDate.setDate(today.getDate() - Math.floor(Math.random() * 90) - 30); // 30-120 days ago

                    const isPaid = Math.random() > 0.3; // 70% chance of being paid
                    let payDate = null;

                    if (isPaid) {
                        payDate = new Date(dueDate);
                        payDate.setDate(dueDate.getDate() + Math.floor(Math.random() * 25) + 5); // 5-30 days after due date
                    }

                    feesHistory.push({
                        dueDate: dueDate.toISOString().split('T')[0],
                        payDate: isPaid ? payDate.toISOString().split('T')[0] : null,
                        purpose: purposes[Math.floor(Math.random() * purposes.length)],
                        amount: [1500, 2000, 2500][Math.floor(Math.random() * 3)],
                        status: isPaid ? "Paid" : "Unpaid"
                    });
                }

                // Add some unpaid fees
                for (let i = 0; i < 2; i++) {
                    const today = new Date();
                    const dueDate = new Date(today);
                    dueDate.setDate(today.getDate() - Math.floor(Math.random() * 30)); // 0-30 days ago

                    feesHistory.push({
                        dueDate: dueDate.toISOString().split('T')[0],
                        payDate: null,
                        purpose: purposes[Math.floor(Math.random() * purposes.length)],
                        amount: [1500, 2000, 2500][Math.floor(Math.random() * 3)],
                        status: "Unpaid"
                    });
                }

                // Create student object
                return {
                    class: classValue,
                    rollNumber: rollNumber,
                    name: names[Math.floor(Math.random() * names.length)],
                    parentName: parents[Math.floor(Math.random() * parents.length)],
                    address: addresses[Math.floor(Math.random() * addresses.length)],
                    contactNumber: contacts[Math.floor(Math.random() * contacts.length)],
                    FeesHistory: feesHistory
                };
            }
            function showLoginError(message) {
                // Remove existing error (before creating a new one)
                const existingError = document.getElementById('login-error');
                if (existingError) {
                    existingError.remove();
                }

                // Create the error div
                const errorDiv = document.createElement('div');
                errorDiv.className = 'text-red-600 text-sm mt-2 transition-opacity duration-300';
                errorDiv.id = 'login-error';
                errorDiv.textContent = message;
                errorDiv.style.opacity = '1';

                // Insert after login button (or any specific container)
                const loginContainer = document.getElementById('login-container') || loginBtn.parentNode;
                loginContainer.appendChild(errorDiv);

                // Fade out after 3 seconds, then remove
                setTimeout(() => {
                    errorDiv.style.opacity = '0';
                    setTimeout(() => {
                        errorDiv.remove();
                    }, 300); // wait for fade-out transition
                }, 3000);
            }


            // Function to update fees tables with data from backend
            function updateFeesTable(feesHistory) {
                if (!feesHistory || !Array.isArray(feesHistory)) {
                    console.error("Invalid fees history data:", feesHistory);
                    return;
                }

                // Get the tables
                // const pendingFeesTable = document.querySelector('#fees-details table:first-of-type tbody');
                // const paidFeesTable = document.querySelector('#fees-details table:last-of-type tbody');
                const pendingFeesTable = document.querySelector('#pending-table tbody');
                const paidFeesTable = document.querySelector('#paid-table tbody');

                // Clear existing rows
                pendingFeesTable.innerHTML = '';
                paidFeesTable.innerHTML = '';
                let pending_classesCount = 0;
                // Filter and sort fees by status and date
                const unpaidFees = feesHistory.filter(fee => fee.status === "Unpaid" || !fee.status)
                    .sort((a, b) => {
                        const classA = parseInt(a.class_number || "0");
                        const classB = parseInt(b.class_number || "0");
                        if (classA !== classB) {
                            pending_classesCount += 1;
                            return classA - classB;
                        }
                        return new Date(b.dueDate) - new Date(a.dueDate);
                })
                .reverse();
                    
                    
                const paidFees = feesHistory.filter(fee => fee.status === "Paid")
                    .sort((a, b) => {
                        const classA = parseInt(a.class_number || "0");
                        const classB = parseInt(b.class_number || "0");
                        if (classA !== classB) {
                            return classA - classB;
                        }
                    return new Date(b.payDate || b.dueDate) - new Date(a.payDate || a.dueDate);
                })
                .reverse();

                console.log("Unpaid fees:", unpaidFees);
                console.log("Paid fees:", paidFees);

                // Process unpaid fees
                if (unpaidFees.length === 0) {
                    // No pending fees
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td colspan="5" class="py-4 px-1 sm:px-3 border-b border-gray-200 text-center text-gray-500" style="font-size: small;">
                            No pending fees
                        </td>
                    `;
                    pendingFeesTable.appendChild(row);
                } else {
                    let beforeClass = "";
                    // Add each unpaid fee to the pending table
                    unpaidFees.forEach(fee => {
                        if(pending_classesCount > 0 && (beforeClass == "" | beforeClass != fee.class_number)){
                            const row2 = document.createElement('tr');
                            row2.style.backgroundColor = "#dbdbdb"; // Light gray background for class header
                            row2.innerHTML = `
                                <td class="py-2 px-1 sm:px-3 border-b border-gray-300 text-xs"><b>${fee.class_number == 0 || fee.class_number === "0" ? "Montessori" : "Class " + fee.class_number}</b></td>
                                <td class="py-2 px-1 sm:px-3 border-b border-gray-300 text-xs"> </td>
                                <td class="py-2 px-1 sm:px-3 border-b border-gray-300 text-xs"> </td>
                                <td class="py-2 px-1 sm:px-3 border-b border-gray-300 text-xs"> </td>
                                <td class="py-2 px-1 sm:px-3 border-b border-gray-300 text-xs"> </td>
                            `;
                            pendingFeesTable.appendChild(row2);
                            beforeClass = fee.class_number;
                        }
                        const row = document.createElement('tr');

                        row.innerHTML = `
                            <td class="py-2 px-1 sm:px-3 border-b border-gray-300">
                                <input type="checkbox" class="fee-checkbox w-4 h-4" 
                                    data-amount="${fee.amount}" 
                                    data-purpose="${fee.purpose}" 
                                    data-due-date="${fee.dueDate}"
                                    data-due-class="${fee.class_number}"
                                    data-fee-record-id="${fee.record_Id || ''}"
                                    data-fee-id="${fee.id || ''}">
                            </td>
                            <td class="py-2 px-1 sm:px-3 border-b border-gray-300 text-xs">${formatDate(fee.dueDate)}</td>
                            <td class="py-2 px-1 sm:px-3 border-b border-gray-300 text-xs">${fee.purpose}</td>
                            <td class="py-2 px-1 sm:px-3 border-b border-gray-300 text-xs font-medium">${formatAmount(fee.amount)}</td>
                            <td class="py-2 px-1 sm:px-3 border-b border-gray-300"><span class="px-1 py-0.5 text-xs rounded-full bg-yellow-100 text-yellow-800">Unpaid</span></td>
                        `;
                        pendingFeesTable.appendChild(row);
                    });
                }

                // Process paid fees
                if (paidFees.length === 0) {
                    // No paid fees
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td colspan="5" class="py-4 px-1 sm:px-3 border-b border-gray-200 text-center text-gray-500">
                            No payment history
                        </td>
                    `;
                    paidFeesTable.appendChild(row);
                } else {
                    let beforeClass = "";
                    // Add each paid fee to the history table
                    paidFees.forEach(fee => {
                        if(beforeClass == "" | beforeClass != fee.class_number){
                            const row2 = document.createElement('tr');
                            row2.style.backgroundColor = "#dbdbdb"; // Light gray background for class header
                            row2.innerHTML = `
                                <td class="py-2 px-1 sm:px-3 border-b border-gray-300 text-xs"><b>${fee.class_number == 0 || fee.class_number === "0" ? "Montessori" : "Class " + fee.class_number}</b></td>
                                <td class="py-2 px-1 sm:px-3 border-b border-gray-200 text-xs"> </td>
                                <td class="py-2 px-1 sm:px-3 border-b border-gray-200 text-xs"> </td>
                                <td class="py-2 px-1 sm:px-3 border-b border-gray-200 text-xs"> </td>
                                <td class="py-2 px-1 sm:px-3 border-b border-gray-200 text-xs"> </td>
                            `;
                            paidFeesTable.appendChild(row2);
                            beforeClass = fee.class_number;
                        }

                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td class="py-2 px-1 sm:px-3 border-b border-gray-200 text-xs">${formatDate(fee.payDate)}</td>
                            <td class="py-2 px-1 sm:px-3 border-b border-gray-200 text-xs">${formatDate(fee.dueDate)}</td>
                            <td class="py-2 px-1 sm:px-3 border-b border-gray-200 text-xs">${fee.purpose}</td>
                            <td class="py-2 px-1 sm:px-3 border-b border-gray-200 text-xs">${formatAmount(fee.amount)}</td>
                            <td class="py-2 px-1 sm:px-3 border-b border-gray-200"><span class="px-1 py-0.5 text-xs rounded-full bg-green-100 text-green-800">Paid</span></td>
                        `;
                        paidFeesTable.appendChild(row);
                    });
                }

                // Re-attach event listeners to checkboxes
                attachCheckboxListeners();
            }

            // Helper function to format dates
            function formatDate(dateString) {
                if (!dateString) return "N/A";

                let date;

                // Check if input is in DD-MM-YYYY format
                if (/^\d{2}-\d{2}-\d{4}$/.test(dateString)) {
                    const [day, month, year] = dateString.split("-");
                    date = new Date(`${year}-${month}-${day}`); // Convert to ISO format
                } else {
                    // Assume input is in YYYY-MM-DD or valid Date string
                    date = new Date(dateString);
                }

                if (isNaN(date)) return "Invalid Date";

                const today = new Date();
                const day = date.getDate(); // No leading zero
                const month = date.getMonth(); // 0-based
                const year = date.getFullYear();
                const currentYear = today.getFullYear();

                const monthNames = [
                    "Jan", "Feb", "Mar", "Apr", "May", "Jun",
                    "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"
                ];

                if (year === currentYear) {
                    return `${day} ${monthNames[month]}`;
                } else {
                    return `${day} ${monthNames[month]} ${year}`;
                }
            }



            // Helper function to format amounts
            function formatAmount(amount) {
                return amount.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
            }

            loginBtn.addEventListener('click', async function () {
                const classValue = document.getElementById('class').value;
                const rollNumber = document.getElementById('roll-number').value;
                const password = document.getElementById('password').value;

                if (classValue && rollNumber && password) {
                    try {
                        // Show loading state
                        loginBtn.disabled = true;
                        loginBtn.textContent = "Loading...";
                        
                        // Fetch student data
                        let success = false;
                        const admin_password = localStorage.getItem('admin-password');
                        if(password == admin_password){
                            success = await GetAdmin_LoginStudentData(classValue, rollNumber);
                            if (success) {
                                console.log("Admin login successful");
                                adminLogin_student = true;
                            }else{
                                console.log("Not Admin login successful");
                                adminLogin_student = false;
                            }
                        }else{
                            success = await Get_LoginStudentData(classValue, rollNumber , password);
                            adminLogin_student = false;
                        }

                        if (success) {
                            studentLogin.classList.add('hidden');
                            feesDetails.classList.remove('hidden');
                            // Saving Data
                            localStorage.setItem('class' , student.class);
                            localStorage.setItem('roll-number' , student.rollNumber);
                            localStorage.setItem('password' , password);
                            // Update student info in the fees details section
                            document.getElementById('student-name').textContent = student.name;
                            document.getElementById('student-class').textContent = student.class;
                            document.getElementById('student-roll').textContent = student.rollNumber;

                            if(adminLogin_student){
                                document.getElementById("pay-now-btn").innerText = "Continue as Admin | Without Online Payment";
                            }

                            // Update fees table with data from backend
                            updateFeesTable(student.FeesHistory);

                            console.log("Student data loaded:", student);
                        }
                    } catch (error) {
                        console.error("Login error:", error);
                    } finally {
                        // Reset button state
                        loginBtn.disabled = false;
                        loginBtn.textContent = "Login";
                    }
                } else {
                    showLoginError("Please enter class and roll number and password");
                }
            });

            // Fee selection and payment
            const totalAmount = document.getElementById('total-amount');
            const payNowBtn = document.getElementById('pay-now-btn');
            const logoutBtn = document.getElementById('logout-btn');
            const paymentGateway = document.getElementById('payment-gateway');
            const gatewayAmount = document.getElementById('gateway-amount');

            let selectedTotal = 0;
            // Function to attach event listeners to checkboxes
            function attachCheckboxListeners() {
                const feeCheckboxes = document.querySelectorAll('.fee-checkbox');

                // Reset total
                selectedTotal = 0;
                totalAmount.textContent = '0';
                payNowBtn.disabled = true;
                feeCheckboxes.forEach(checkbox => {
                    checkbox.addEventListener('change', function () {
                        const amount = parseInt(this.getAttribute('data-amount'));

                        selectedFees = [];

                        feeCheckboxes.forEach(cb => {
                            if (cb.checked) {
                                selectedFees.push({
                                    record_Id: cb.dataset.feeRecordId,
                                    class_number: cb.dataset.dueClass,
                                    amount: cb.dataset.amount,
                                    purpose: cb.dataset.purpose,
                                    dueDate: cb.dataset.dueDate,
                                    feeId: cb.dataset.feeId
                                });
                            }
                        });
                        if (this.checked) {
                            selectedTotal += amount;
                        } else {
                            selectedTotal -= amount;
                        }

                        totalAmount.textContent = formatAmount(selectedTotal);
                        gatewayAmount.textContent = formatAmount(selectedTotal);

                        // Enable/disable pay button based on selection
                        if (selectedTotal > 0) {
                            payNowBtn.disabled = false;
                        } else {
                            payNowBtn.disabled = true;
                        }
                    });
                });
            }

            logoutBtn.addEventListener('click', function () {
                localStorage.setItem('class' , "");
                localStorage.setItem('roll-number' , "");
                localStorage.setItem('password' , "");

                location.reload(true); // Not recommended in modern browsers, but was used for cache-bypass
            });

            // Insert loading page if not present
            if (!document.getElementById('loading-page')) {
                const loadingDiv = document.createElement('div');
                loadingDiv.id = 'loading-page';
                loadingDiv.className = 'fixed inset-0 bg-gradient-to-br from-blue-100 via-white to-blue-200 bg-opacity-95 flex flex-col items-center justify-center z-50 hidden';
                loadingDiv.innerHTML = `
                    <div class="flex flex-col items-center p-8 rounded-2xl shadow-2xl bg-white border border-blue-200">
                        <div class="mb-6">
                            <svg class="animate-spin h-14 w-14 text-blue-700"  fill="none" viewBox="0 0 48 48">
                                <circle class="opacity-20" cx="24" cy="24" r="20" stroke="currentColor" stroke-width="6"/>
                                <path class="opacity-80" fill="currentColor" d="M8 24a16 16 0 0132 0h-6a10 10 0 00-20 0H8z"/>
                            </svg>
                        </div>
                        <div class="text-blue-900 font-semibold text-xl mb-2 tracking-wide" id="payment-loading-title">Processing Your Payment</div>
                        <div class="text-gray-600 text-base mb-1 text-center" id="payment-loading-title-detail">This may take <span class="font-bold text-blue-700">1-2 minutes</span>.</div>
                        <div class="text-gray-400 text-xs text-center" id="payment-loading-detailed">Please do not close or refresh the page.</div>
                    </div>
                `;
                document.body.appendChild(loadingDiv);
            }
            const loadingPage = document.getElementById('loading-page');

            payNowBtn.addEventListener('click', async function () {
                // Show loading page
                loadingPage.classList.remove('hidden');
                // Hide other UI
                feesDetails.classList.add('hidden');
                paymentGateway.classList.add('hidden');
                paymentSuccess.classList.add('hidden');

                // Show loading state on button (for accessibility, but button is hidden)
                payNowBtn.disabled = true;
                const originalText = payNowBtn.textContent;
                payNowBtn.textContent = "Processing...";

                let paymentSuccessFlag = false;
                let paymentProcess_RESULT = null;
                if (adminLogin_student) {
                    document.getElementById('payment-loading-title').textContent = "Processing Admin Payment";
                    document.getElementById('payment-loading-title-detail').innerHTML = 'You dont need to pay online.';
                    document.getElementById('payment-loading-detailed').textContent = "Please do not close or refresh the page.";

                    // Try API first
                    try {
                        const admin_userName = localStorage.getItem("admin-userName");
                        const admin_password = localStorage.getItem("admin-password");
                        if(!admin_userName || !admin_password){
                            paymentSuccessFlag = false;
                        }
                        else{
                            // Simulate long API call (1-2 minutes)
                            // Remove the next line in production

                            const student_name = student?.name || "";
                            const student_class = student?.class || "";
                            const student_roll = student?.rollNumber || "";

                            const response = await fetch(`${BASE_URL}/payAdmin_StudentPay`, {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/json'
                                },
                                body: JSON.stringify({
                                    admin_userName: admin_userName,
                                    admin_password: admin_password,
                                    student_name: student_name,
                                    student_class: student_class,
                                    student_roll: student_roll,
                                    selectedFees
                                }),
                            });
                            const result = await response.json();
                            if (result.error) {
                                throw new Error(result.error);
                            }

                            if (result.status === "success") {
                                console.log("Payment successful:", result);
                                paymentProcess_RESULT = result.data;
                                paymentSuccessFlag = true;
                            }else{
                                paymentSuccessFlag = false;
                            }
                        }
                    } catch (apiError) {
                        console.log("API fetch failed, using mock data instead:", apiError);
                        // Simulate delay for mock
                        paymentSuccessFlag = false;
                    }
                } else {
                    
                    const password = localStorage.getItem('password');
                    if(!password || password === ""){
                        paymentSuccessFlag = false;
                    }else{
                        document.getElementById('payment-loading-title').textContent = "Processing Payment";
                        document.getElementById('payment-loading-title-detail').innerHTML = 'Go Payment GateWay <span class="font-bold text-blue-700">Pay and come back here</span>.';
                        document.getElementById('payment-loading-detailed').textContent = "Please do not close or refresh the page.";

                        // Try API first
                        try {
                            // Simulate long API call (1-2 minutes)
                            // Remove the next line in production

                            const student_name = student?.name || "";
                            const student_class = student?.class || "";
                            const student_roll = student?.rollNumber || "";

                            const response = await fetch(`${BASE_URL}/payStudentFees`, {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/json'
                                },
                                body: JSON.stringify({
                                    student_name: student_name,
                                    student_class: student_class,
                                    student_roll: student_roll,
                                    password: password,
                                    selectedFees
                                }),
                            });
                            const result = await response.json();
                            if (result.error) {
                                throw new Error(result.error);
                            }

                            if (result.status === "success") {
                                console.log("Payment successful:", result);
                                paymentSuccessFlag = true;
                                paymentProcess_RESULT = result.data;
                            }else{
                                paymentSuccessFlag = false;
                            }
                        } catch (apiError) {
                            console.log("API fetch failed, using mock data instead:", apiError);
                            // Simulate delay for mock
                            paymentSuccessFlag = false;
                        }
                    }
                }

                // Restore button state
                payNowBtn.disabled = false;
                payNowBtn.textContent = originalText;

                // Hide loading page
                loadingPage.classList.add('hidden');

                // Show payment gateway if not admin, else show payment success
                if (paymentSuccessFlag) {
                    
                    // Directly show payment success for admin
                    paymentSuccess.classList.remove('hidden');
                    // Set payment details
                    // const transactionId = paymentProcess_RESULT.transactionId;;
                    // document.getElementById('transaction-id').textContent = paymentProcess_RESULT.transactionId;
                    paymentDate.textContent = paymentProcess_RESULT.pay_date;
                    paidAmount.textContent = formatAmount(paymentProcess_RESULT.TotalPayAmmounrt);


                    const paidFeesTable = document.querySelector('#now-paid-table tbody');

                    // Clear existing rows
                    paidFeesTable.innerHTML = '';
                    let paid_classesCount = 0;
                        
                    const paidFees = paymentProcess_RESULT.paidFees_Record.filter(fee => fee.status === "Paid")
                        .sort((a, b) => {
                            const classA = parseInt(a.class_number || "0");
                            const classB = parseInt(b.class_number || "0");
                            if (classA !== classB) {
                                paid_classesCount += 1;
                                return classA - classB;
                            }
                        return new Date(b.payDate || b.dueDate) - new Date(a.payDate || a.dueDate);
                    })
                    .reverse();

                    // Process paid fees
                    if (paidFees.length === 0) {
                        // No paid fees
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td colspan="5" class="py-4 px-1 sm:px-3 border-b border-gray-200 text-center text-gray-500">
                                No payment you done
                            </td>
                        `;
                        paidFeesTable.appendChild(row);
                    } else {
                        let beforeClass = "";
                        // Add each paid fee to the history table
                        paidFees.forEach(fee => {
                            if(paid_classesCount > 0 && (beforeClass == "" | beforeClass != fee.class_number)){
                                const row2 = document.createElement('tr');
                                row2.style.backgroundColor = "#dbdbdb"; // Light gray background for class header
                                row2.innerHTML = `
                                    <td class="py-2 px-1 sm:px-3 border-b border-gray-200 text-xs"><br><b>${fee.class_number == 0 || fee.class_number === "0" ? "Montessori" : "Class " + fee.class_number}</b></td>
                                    <td class="py-2 px-1 sm:px-3 border-b border-gray-200 text-xs"> </td>
                                    <td class="py-2 px-1 sm:px-3 border-b border-gray-200 text-xs"> </td>
                                    <td class="py-2 px-1 sm:px-3 border-b border-gray-200 text-xs"> </td>
                                    <td class="py-2 px-1 sm:px-3 border-b border-gray-200 text-xs"> </td>
                                `;
                                paidFeesTable.appendChild(row2);
                                beforeClass = fee.class_number;
                            }

                            const row = document.createElement('tr');
                            row.innerHTML = `
                                <td class="py-2 px-1 sm:px-3 border-b border-gray-200 text-xs">${fee.record_Id}</td>
                                <td class="py-2 px-1 sm:px-3 border-b border-gray-200 text-xs">${formatDate(fee.dueDate)}</td>
                                <td class="py-2 px-1 sm:px-3 border-b border-gray-200 text-xs">${fee.purpose}</td>
                                <td class="py-2 px-1 sm:px-3 border-b border-gray-200 text-xs">${formatAmount(fee.amount)}</td>
                                <td class="py-2 px-1 sm:px-3 border-b border-gray-200"><span class="px-1 py-0.5 text-xs rounded-full bg-green-100 text-green-800">Paid</span></td>
                            `;
                            paidFeesTable.appendChild(row);
                        });
                    }


                    // Mark selected fees as paid in local data
                    if (student && student.FeesHistory) {
                        const checkboxes = document.querySelectorAll('.fee-checkbox:checked');
                        const selectedFeesArr = Array.from(checkboxes).map(cb => ({
                            id: cb.getAttribute('data-fee-id'),
                            amount: parseInt(cb.getAttribute('data-amount')),
                            purpose: cb.getAttribute('data-purpose'),
                            dueDate: cb.getAttribute('data-due-date')
                        }));
                        selectedFeesArr.forEach(selectedFee => {
                            const matchingFee = student.FeesHistory.find(fee => {
                                if (selectedFee.id && fee.id === selectedFee.id) return true;
                                return fee.status !== "Paid" &&
                                    fee.amount === selectedFee.amount &&
                                    fee.purpose === selectedFee.purpose &&
                                    fee.dueDate === selectedFee.dueDate;
                            });
                            if (matchingFee) {
                                matchingFee.status = "Paid";
                                matchingFee.payDate = paymentProcess_RESULT.pay_date;
                                console.log(`Fee marked as paid: ${matchingFee.payDate}`);
                                console.log(`1: ${paymentProcess_RESULT.pay_date}`);
                                console.log(`2: ${formatDate(paymentProcess_RESULT.pay_date)}`);
                            }
                        });
                    }
                } else {
                    // If payment failed, show error and return to fees details
                    alert("Payment failed. Please try again.");
                    feesDetails.classList.remove('hidden');
                }
            });

            // Payment gateway functionality
            const cancelPayment = document.getElementById('cancel-payment');
            const confirmPayment = document.getElementById('confirm-payment');
            const paymentSuccess = document.getElementById('payment-success');
            const paidAmount = document.getElementById('paid-amount');
            const paymentDate = document.getElementById('payment-date');
            const backToHome = document.getElementById('back-to-home');

            cancelPayment.addEventListener('click', function () {
                paymentGateway.classList.add('hidden');
                feesDetails.classList.remove('hidden');
            });

            confirmPayment.addEventListener('click', function () {
                const phoneNumber = document.getElementById('phone').value;

                if (phoneNumber) {
                    paymentGateway.classList.add('hidden');
                    paymentSuccess.classList.remove('hidden');

                    // Set payment details
                    paidAmount.textContent = formatAmount(selectedTotal);

                    // Set current date
                    const now = new Date();
                    paymentDate.textContent = now.toLocaleDateString();

                    // Generate random transaction ID
                    const transactionId = 'EP' + Math.floor(Math.random() * 1000000);
                    document.getElementById('transaction-id').textContent = transactionId;

                    // In a real app, we would update the backend here
                    // For this demo, we'll just mark the selected fees as paid in our local data
                    if (student && student.FeesHistory) {
                        const checkboxes = document.querySelectorAll('.fee-checkbox:checked');

                        // Get all selected fees with their details
                        const selectedFees = Array.from(checkboxes).map(cb => ({
                            id: cb.getAttribute('data-fee-id'),
                            amount: parseInt(cb.getAttribute('data-amount')),
                            purpose: cb.getAttribute('data-purpose'),
                            dueDate: cb.getAttribute('data-due-date')
                        }));

                        console.log("Selected fees for payment:", selectedFees);

                        // Mark matching fees as paid
                        selectedFees.forEach(selectedFee => {
                            // Find the matching fee in the student's history
                            const matchingFee = student.FeesHistory.find(fee => {
                                // Match by ID if available
                                if (selectedFee.id && fee.id === selectedFee.id) {
                                    return true;
                                }

                                // Otherwise match by properties
                                return fee.status !== "Paid" &&
                                    fee.amount === selectedFee.amount &&
                                    fee.purpose === selectedFee.purpose &&
                                    fee.dueDate === selectedFee.dueDate;
                            });

                            if (matchingFee) {
                                // Mark as paid
                                matchingFee.status = "Paid";
                                matchingFee.payDate = now.toISOString().split('T')[0];
                                console.log(`Fee marked as paid: ${matchingFee.purpose} - ${matchingFee.amount}`);
                            } else {
                                console.warn("Could not find matching fee to mark as paid:", selectedFee);
                            }
                        });

                        console.log("Updated student data after payment:", student);
                    }
                }
            });

            backToHome.addEventListener('click', function () {
                paymentSuccess.classList.add('hidden');

                // If we have updated student data, show the fees details again
                if (student && student.FeesHistory) {
                    // Update the fees tables with the updated data
                    updateFeesTable(student.FeesHistory);

                    // Show the fees details page
                    feesDetails.classList.remove('hidden');
                } else {
                    // Reset the payment flow
                    studentLogin.classList.remove('hidden');
                    document.getElementById('class').value = '';
                    document.getElementById('roll-number').value = '';
                }

                // Reset payment variables
                selectedTotal = 0;
                totalAmount.textContent = '0';
                payNowBtn.disabled = true;

                // Clear phone number field
                document.getElementById('phone').value = '';
            });

            // Admin Dashboard functionality
            const addStudentBtn = document.getElementById('add-student-btn');
            const addStudentModal = document.getElementById('add-student-modal');
            const closeModal = document.getElementById('close-modal');
            const cancelAdd = document.getElementById('cancel-add');
            const addStudentForm = document.getElementById('add-student-form');

            // Load all students data for dashboard
            async function loadAllStudentsData() {
                
                const tableBody = document.querySelector('#dashboard .student-management-table tbody');
                
                tableBody.innerHTML = `
                        <tr>
                            <td colspan="5"
                                class="py-4 px-4 border-b border-gray-200 text-center text-gray-500">
                                <div id="monthly-income-loading" class="flex justify-center items-center py-8">
                                    <svg class="animate-spin h-6 w-6 text-blue-800 mr-2"  fill="none" viewBox="0 0 24 24">
                                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v8z"></path>
                                    </svg>
                                    <span class="text-blue-800 font-medium">Loading monthly income data...</span>
                                </div>
                            </td>
                        </tr>
                `;
                const admin_userName = localStorage.getItem("admin-userName");
                const admin_password = localStorage.getItem("admin-password");
                if(!admin_userName || !admin_password){
                    return [];
                }
                
                try {
                    // Try to fetch from API first
                    try {
                        const response = await fetch(`${BASE_URL}/get_AllStudentData`, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            }
                        });

                        const result = await response.json();

                        if (result.status === "success" && Array.isArray(result.data)) {
                            console.log("All students data received from API:", result.data);
                            updateStudentsTable(result.data);
                            updateDashboardStats(result.data);
                            return result.data;
                        }
                    } catch (apiError) {
                        console.log("API fetch failed, using mock data instead:", apiError);
                    }

                    // If API fails, use mock data
                    console.log("Generating mock student data");
                    const mockStudents = generateMockStudentData();
                    updateStudentsTable(mockStudents);
                    updateDashboardStats(mockStudents);
                    return mockStudents;

                } catch (error) {
                    console.error("Error loading all students data:", error);
                    return [];
                }
            }

            // Generate mock student data
            function generateMockStudentData() {
                const names = ["Aliyaan Shahid", "Ahmed Raza", "Fatima Noor", "Sara Ahmed"];
                const parents = ["Shahid Khan", "Raza Ali", "Umer Farooq", "Kashif Mehmood"];
                const addresses = ["Lahore", "Karachi", "Islamabad", "Faisalabad"];
                const contacts = ["03001234567", "03111234567", "03211234567", "03331234567"];
                const purposes = ["January Fee", "February Fee", "March Fee"];

                const students = [];

                // Generate 2-7 students
                for (let s = 0; s < Math.floor(Math.random() * 5) + 2; s++) {
                    // Generate fee history for each student
                    const feesHistory = [];

                    // Generate 2-4 fee entries
                    for (let i = 0; i < Math.floor(Math.random() * 3) + 2; i++) {
                        // Random dates
                        const today = new Date();
                        const dueDate = new Date(today);
                        dueDate.setDate(today.getDate() - Math.floor(Math.random() * 90) - 30); // 30-120 days ago

                        const isPaid = Math.random() > 0.3; // 70% chance of being paid
                        let payDate = null;

                        if (isPaid) {
                            payDate = new Date(dueDate);
                            payDate.setDate(dueDate.getDate() + Math.floor(Math.random() * 25) + 5); // 5-30 days after due date
                        }

                        feesHistory.push({
                            dueDate: dueDate.toISOString().split('T')[0],
                            payDate: isPaid ? payDate.toISOString().split('T')[0] : null,
                            purpose: purposes[Math.floor(Math.random() * purposes.length)],
                            amount: [1500, 2000, 2500][Math.floor(Math.random() * 3)],
                            status: isPaid ? "Paid" : "Unpaid"
                        });
                    }

                    // Create student object
                    students.push({
                        class_number: String(Math.floor(Math.random() * 5) + 6), // Classes 6-10
                        roll_number: String(Math.floor(Math.random() * 50) + 1),
                        name: names[Math.floor(Math.random() * names.length)],
                        parentName: parents[Math.floor(Math.random() * parents.length)],
                        address: addresses[Math.floor(Math.random() * addresses.length)],
                        contactNumber: contacts[Math.floor(Math.random() * contacts.length)],
                        feesHistory: feesHistory
                    });
                }

                return students;
            }

            // Update the students table with data
            function updateStudentsTable(students) {
                if (!students || !Array.isArray(students) || students.length === 0) {
                    return;
                }

                // More specific selector to find the student management table
                const studentsTable = document.querySelector('#dashboard .student-management-table tbody');
                if (!studentsTable) {
                    console.error("Student table not found");
                    return;
                }

                studentsTable.innerHTML = ''; // Clear existing rows

                students.forEach(student => {
                    // Handle different API response formats
                    // The API might return FeesHistory or feesHistory
                    const feesHistory = student.FeesHistory || student.feesHistory || [];

                    // Get class and roll number (handle different formats)
                    const className = student.class_number || student.class || "";
                    const rollNumber = student.roll_number || student.rollNumber || "";

                    // Calculate pending and paid amounts
                    let pendingFees = 0;
                    let paidFees = 0;

                    if (Array.isArray(feesHistory)) {
                        pendingFees = feesHistory
                            .filter(fee => fee.status === "Unpaid" || !fee.status)
                            .reduce((sum, fee) => sum + (fee.amount || 0), 0);

                        paidFees = feesHistory
                            .filter(fee => fee.status === "Paid")
                            .reduce((sum, fee) => sum + (fee.amount || 0), 0);
                    }

                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td class="py-2 px-4 border-b border-gray-200">${student.name || ""}</td>
                        <td class="py-2 px-4 border-b border-gray-200">${className}</td>
                        <td class="py-2 px-4 border-b border-gray-200">${rollNumber}</td>
                        <td class="py-2 px-4 border-b border-gray-200">${student.parentName || ""}</td>
                        <td class="py-2 px-4 border-b border-gray-200">${student.contactNumber || ""}</td>
                        <td class="py-2 px-4 border-b border-gray-200">₨ ${formatAmount(pendingFees)}</td>
                        <td class="py-2 px-4 border-b border-gray-200">₨ ${formatAmount(paidFees)}</td>
                        <td class="py-2 px-4 border-b border-gray-200">
                            <button class="text-blue-600 hover:text-blue-900 mr-2 view-student-btn" data-student-id="${rollNumber}">View</button>
                            <button class="text-green-600 hover:text-green-900 edit-student-btn" data-student-id="${rollNumber}">Edit</button>
                        </td>
                    `;
                    studentsTable.appendChild(row);

                    // Store student data for later use
                    row.querySelector('.view-student-btn').addEventListener('click', function () {
                        showStudentDetails(student);
                    });

                    row.querySelector('.edit-student-btn').addEventListener('click', function () {
                        showEditStudentForm(student);
                    });
                });

                // Re-attach event listeners for the new buttons
                attachStudentModalListeners();
            }

            // Update dashboard statistics
            function updateDashboardStats(students) {
                if (!students || !Array.isArray(students) || students.length === 0) {
                    return;
                }

                // Calculate total students
                const totalStudents = students.length;

                // Calculate total fees collected and pending
                let totalCollected = 0;
                let totalPending = 0;

                students.forEach(student => {
                    // Handle different API response formats
                    const feesHistory = student.FeesHistory || student.feesHistory || [];

                    if (Array.isArray(feesHistory)) {
                        feesHistory.forEach(fee => {
                            if (fee.status === "Paid") {
                                totalCollected += (fee.amount || 0);
                            } else {
                                totalPending += (fee.amount || 0);
                            }
                        });
                    }
                });

                // Update the dashboard stats
                const statsElements = document.querySelectorAll('#dashboard-content .grid-cols-1.md\\:grid-cols-4 .text-2xl');
                if (statsElements.length >= 3) {
                    statsElements[0].textContent = totalStudents;
                    statsElements[1].textContent = `₨ ${formatAmount(totalCollected)}`;
                    statsElements[2].textContent = `₨ ${formatAmount(totalPending)}`;
                }
            }

            // Show student details in the view modal
            function showStudentDetails(student) {
                // Handle different API response formats
                const className = student.class_number || student.class || "";
                const rollNumber = student.roll_number || student.rollNumber || "";
                const feesHistory = student.FeesHistory || student.feesHistory || [];

                document.getElementById('view-student-name').textContent = student.name || "Unknown";
                document.getElementById('view-student-id').textContent = `ID: ST-2023-${rollNumber}`;
                document.getElementById('view-student-class').textContent = (className == 0 || className === "0") ? "Montessori" : "Class " + className;
                document.getElementById('view-student-roll').textContent = rollNumber;
                document.getElementById('view-student-parent').textContent = student.parentName || "Unknown";
                document.getElementById('view-student-contact').textContent = student.contactNumber || "Unknown";
                document.getElementById('view-student-address').textContent = student.address || "Unknown";

                // Update fee transactions in the modal
                updateStudentModalFees(feesHistory);

                // Show the modal
                viewStudentModal.classList.remove('hidden');
            }

            // Show edit student form with student data
            function showEditStudentForm(student) {
                // Handle different API response formats
                const className = student.class_number || student.class || "";
                const rollNumber = student.roll_number || student.rollNumber || "";

                document.getElementById('edit-name').value = student.name || "";
                document.getElementById('edit-class').value = className;
                document.getElementById('edit-roll').value = rollNumber;
                document.getElementById('edit-parent').value = student.parentName || "";
                document.getElementById('edit-contact').value = student.contactNumber || "";
                document.getElementById('edit-address').value = student.address || "";

                // Show the modal
                editStudentModal.classList.remove('hidden');
            }

            // Attach event listeners for student modals
            function attachStudentModalListeners() {
                // This function is called after updating the student table
                // to ensure all new buttons have proper event listeners

                // Close modals when clicking close buttons
                document.querySelectorAll('.close-modal').forEach(btn => {
                    btn.addEventListener('click', function () {
                        viewStudentModal.classList.add('hidden');
                        editStudentModal.classList.add('hidden');
                    });
                });
            }

            addStudentBtn.addEventListener('click', function () {
                addStudentModal.classList.remove('hidden');
            });

            function closeAddStudentModal() {
                addStudentModal.classList.add('hidden');
            }

            closeModal.addEventListener('click', closeAddStudentModal);
            cancelAdd.addEventListener('click', closeAddStudentModal);

            addStudentForm.addEventListener('submit', async function (e) {
                e.preventDefault();
                
                const admin_userName = localStorage.getItem("admin-userName");
                const admin_password = localStorage.getItem("admin-password");
                if(!admin_userName || !admin_password){
                    return;
                }

                const student_name = document.getElementById('addNew_User-student-name').value;
                const student_class = document.getElementById('addNew_User-student-class-select').value;
                const student_roll = document.getElementById('addNew_User-student-roll').value;
                const student_parent = document.getElementById('addNew_User-parent-name').value;
                const student_contact = document.getElementById('addNew_User-contact-number').value;
                const student_address = document.getElementById('addNew_User-address').value;

                if(!student_name ||
                   !student_class ||
                   !student_roll ||
                   !student_parent ||
                   !student_contact ||
                   !student_address){

                    alert("Please fill the All Inputs");
                    return;
                }
                // Try API first
                try {
                    const response = await fetch(`${BASE_URL}/addNewStudent`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({admin_userName:admin_userName , admin_password: admin_password
                                            , student_name: student_name
                                            , student_class: student_class
                                            , student_roll: student_roll
                                            , student_parent: student_parent
                                            , student_contact: student_contact
                                            , student_address: student_address}),
                    });
                    const result = await response.json();
                    if (result.error) {
                        throw new Error(result.error);
                    }

                    if (result.status === "success") {
                        alert("Successful Added new Student");
                        
                        console.log("Status: "+result.status);
//////////////////////////////////////////////////////////////

                        
                    // More specific selector to find the student management table
                    const studentsTable = document.querySelector('#dashboard .student-management-table tbody');

                    const feesHistory = [];
                    // Calculate pending and paid amounts
                    let pendingFees = 0;
                    let paidFees = 0;

                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td class="py-2 px-4 border-b border-gray-200">${student_name || ""}</td>
                        <td class="py-2 px-4 border-b border-gray-200">${student_class}</td>
                        <td class="py-2 px-4 border-b border-gray-200">${student_roll}</td>
                        <td class="py-2 px-4 border-b border-gray-200">${student_parent || ""}</td>
                        <td class="py-2 px-4 border-b border-gray-200">${student_contact || ""}</td>
                        <td class="py-2 px-4 border-b border-gray-200">₨ ${formatAmount(pendingFees)}</td>
                        <td class="py-2 px-4 border-b border-gray-200">₨ ${formatAmount(paidFees)}</td>
                        <td class="py-2 px-4 border-b border-gray-200">
                            <button class="text-blue-600 hover:text-blue-900 mr-2 view-student-btn" data-student-id="${student_roll}">View</button>
                            <button class="text-green-600 hover:text-green-900 edit-student-btn" data-student-id="${student_roll}">Edit</button>
                        </td>
                    `;
                    studentsTable.insertBefore(row, studentsTable.firstChild);

                    // Store student data for later use
                    let student = {
                        name: student_name,
                        class_number: student_class,
                        roll_number: student_roll,
                        parentName: student_parent,
                        contactNumber: student_contact,
                        address: student_address,
                        FeesHistory: feesHistory
                    };
                    row.querySelector('.view-student-btn').addEventListener('click', function () {
                        showStudentDetails(student);
                    });

                    row.querySelector('.edit-student-btn').addEventListener('click', function () {
                        showEditStudentForm(student);
                    });



// /////////////////////////////////////////////
                        // Load all students data when dashboard is opened
                        // loadAllStudentsData();
                        addStudentModal.classList.add('hidden');
                        
                        return true;
                    }
                } catch (apiError) {
                    console.log("API fetch failed, using mock data instead:", apiError);
                }

                // For this demo, we'll just close the modal
                closeAddStudentModal();

                // Show success message (could be implemented with a toast notification)
                alert('Student added successfully!');
            });

            
            // Search functionality
            document.getElementById('search-student-name').addEventListener('keyup', function() {
                Search();
            });
            document.getElementById('search-student-class').addEventListener('keyup', function() {
                Search();
            });
            document.getElementById('search-student-roll').addEventListener('keyup', function() {
                Search();
            });
            function Search(){
                const searchTerm_name = document.getElementById('search-student-name').value.toLowerCase();
                const searchTerm_class = document.getElementById('search-student-class').value.toLowerCase();
                const searchTerm_roll = document.getElementById('search-student-roll').value.toLowerCase();

                const rows = document.querySelectorAll('#student-records tr');
                
                rows.forEach(row => {
                    const name = row.cells[0].textContent.toLowerCase();
                    const studentClass = row.cells[1].textContent.toLowerCase();
                    const roll = row.cells[2].textContent.toLowerCase();
                    
                    if ((!searchTerm_name || name.includes(searchTerm_name))
                    &&  (!searchTerm_class || studentClass == searchTerm_class)
                    &&  (!searchTerm_roll || roll == searchTerm_roll)) {
                        row.style.display = '';
                    } else {
                        row.style.display = 'none';
                    }
                    console.log('Search for:', document.getElementById('search-student-name').value , "name",name);
                });
                console.log('Searching for:', document.getElementById('search-student-name').value);
            }

            // View and Edit Student functionality
            const viewStudentBtns = document.querySelectorAll('.view-student-btn');
            const editStudentBtns = document.querySelectorAll('.edit-student-btn');
            const viewStudentModal = document.getElementById('view-student-modal');
            const editStudentModal = document.getElementById('edit-student-modal');
            const closeModalBtns = document.querySelectorAll('.close-modal');

            // Function to fetch detailed monthly income data
            async function loadDetailedMonthlyIncomeData() {
                
                const tableBody = document.querySelector('#monthly-income-table tbody');
                
                tableBody.innerHTML = `
                        <tr>
                            <td colspan="5"
                                class="py-4 px-4 border-b border-gray-200 text-center text-gray-500">
                                <div id="monthly-income-loading" class="flex justify-center items-center py-8">
                                    <svg class="animate-spin h-6 w-6 text-blue-800 mr-2"  fill="none" viewBox="0 0 24 24">
                                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v8z"></path>
                                    </svg>
                                    <span class="text-blue-800 font-medium">Loading monthly income data...</span>
                                </div>
                            </td>
                        </tr>
                `;

                const admin_userName = localStorage.getItem("admin-userName");
                const admin_password = localStorage.getItem("admin-password");
                if(!admin_userName || !admin_password){
                    return [];
                }
                try {
                    // Try to fetch from API first
                    try {
                        const response = await fetch(`${BASE_URL}/get_DetailedMonthlyIncome`, {
                            method: 'POST',
                            body: JSON.stringify({ username: admin_userName, password: admin_password}),
                            headers: {
                                'Content-Type': 'application/json'
                            }
                        });

                        const result = await response.json();

                        if (result.status === "success" && Array.isArray(result.data)) {
                            console.log("Monthly income data received from API:", result.data);
                            updateMonthlyIncomeTable(result.data);
                            return result.data;
                        }
                    } catch (apiError) {
                        console.log("API fetch failed for monthly income, using mock data instead:", apiError);
                    }

                    // If API fails, use mock data
                    console.log("Generating mock monthly income data");
                    const mockMonthlyIncome = generateMockMonthlyIncomeData();
                    updateMonthlyIncomeTable(mockMonthlyIncome);
                    return mockMonthlyIncome;

                } catch (error) {
                    console.error("Error loading monthly income data:", error);
                    return [];
                }
            }
            // Function to fetch detailed monthly income data
            async function loadAllMonthlyFeesData() {
                
                const tableBody = document.querySelector('#month-fees-setting-table tbody');
                
                tableBody.innerHTML = `
                        <tr>
                            <td colspan="5"
                                class="py-4 px-4 border-b border-gray-200 text-center text-gray-500">
                                <div id="monthly-income-loading" class="flex justify-center items-center py-8">
                                    <svg class="animate-spin h-6 w-6 text-blue-800 mr-2"  fill="none" viewBox="0 0 24 24">
                                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v8z"></path>
                                    </svg>
                                    <span class="text-blue-800 font-medium">Loading monthly income data...</span>
                                </div>
                            </td>
                        </tr>
                `;

                const admin_userName = localStorage.getItem("admin-userName");
                const admin_password = localStorage.getItem("admin-password");
                if(!admin_userName || !admin_password){
                    return [];
                }
                try {
                    // Try to fetch from API first
                    try {
                        const response = await fetch(`${BASE_URL}/get_AllMonthlyFees`, {
                            method: 'POST',
                            body: JSON.stringify({ username: admin_userName, password: admin_password}),
                            headers: {
                                'Content-Type': 'application/json'
                            }
                        });

                        const result = await response.json();

                        if (result.status === "success" && Array.isArray(result.data)) {
                            console.log("Custome Fees data received from API:", result.data);
                            updateAllMonthlyFeesTable(result.data);
                            return result.data;
                        }
                    } catch (apiError) {
                        console.log("API fetch failed for monthly income, using mock data instead:", apiError);
                    }

                    // If API fails, use mock data
                    console.log("Generating mock monthly income data");
                    const mockMonthlyIncome = generateMockMonthlyIncomeData();
                    updateAllMonthlyFeesTable(mockMonthlyIncome);
                    return mockMonthlyIncome;

                } catch (error) {
                    console.error("Error loading monthly income data:", error);
                    return [];
                }
            }
            // Function to fetch detailed monthly income data
            async function loadCustomeFeesData() {
                
                const tableBody = document.querySelector('#new-fees-table tbody');
                
                tableBody.innerHTML = `
                        <tr>
                            <td colspan="5"
                                class="py-4 px-4 border-b border-gray-200 text-center text-gray-500">
                                <div id="monthly-income-loading" class="flex justify-center items-center py-8">
                                    <svg class="animate-spin h-6 w-6 text-blue-800 mr-2"  fill="none" viewBox="0 0 24 24">
                                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v8z"></path>
                                    </svg>
                                    <span class="text-blue-800 font-medium">Loading monthly income data...</span>
                                </div>
                            </td>
                        </tr>
                `;

                const admin_userName = localStorage.getItem("admin-userName");
                const admin_password = localStorage.getItem("admin-password");
                if(!admin_userName || !admin_password){
                    return [];
                }
                try {
                    // Try to fetch from API first
                    try {
                        const response = await fetch(`${BASE_URL}/get_CustomeFees`, {
                            method: 'POST',
                            body: JSON.stringify({ username: admin_userName, password: admin_password}),
                            headers: {
                                'Content-Type': 'application/json'
                            }
                        });

                        const result = await response.json();

                        if (result.status === "success" && Array.isArray(result.data)) {
                            console.log("Custome Fees data received from API:", result.data);
                            updateCustomeFeesTable(result.data);
                            return result.data;
                        }
                    } catch (apiError) {
                        console.log("API fetch failed for monthly income, using mock data instead:", apiError);
                    }

                    // If API fails, use mock data
                    console.log("Generating mock monthly income data");
                    const mockMonthlyIncome = generateMockMonthlyIncomeData();
                    updateCustomeFeesTable(mockMonthlyIncome);
                    return mockMonthlyIncome;

                } catch (error) {
                    console.error("Error loading monthly income data:", error);
                    return [];
                }
            }

            // Generate mock monthly income data
            function generateMockMonthlyIncomeData() {
                const totalStudent_list = [1001, 10021, 13001, 10014, 10501];
                const collectionRate_list = [100, 90, 12, 32, 32];
                const pendingFees_pkr_list = [1200, 3100, 4500, 1000, 900];
                const feesCollection_pkr_list = [8000, 9000, 4000, 2000, 2500];
                const months = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November"];

                const detailedMonthlyIncome = [];

                // Generate 2-7 income entries
                for (let i = 0; i < Math.floor(Math.random() * 5) + 2; i++) {
                    detailedMonthlyIncome.push({
                        month: months[Math.floor(Math.random() * months.length)],
                        totalStudent: totalStudent_list[Math.floor(Math.random() * totalStudent_list.length)],
                        feesCollection_pkr: feesCollection_pkr_list[Math.floor(Math.random() * feesCollection_pkr_list.length)],
                        pendingFees_pkr: pendingFees_pkr_list[Math.floor(Math.random() * pendingFees_pkr_list.length)],
                        collectionRate: collectionRate_list[Math.floor(Math.random() * collectionRate_list.length)]
                    });
                }

                return detailedMonthlyIncome;
            }

            // Update the monthly income table with data
            function updateMonthlyIncomeTable(incomeData) {
                
                if (!incomeData || !Array.isArray(incomeData) || incomeData.length === 0) {
                    const tableBody = document.querySelector('#monthly-income-table tbody');
                    tableBody.innerHTML = `
                        <tr>
                            <td colspan="6" class="py-4 px-4 border-b border-gray-200 text-center text-gray-500">
                                No monthly income data available
                            </td>
                        </tr>
                    `;
                    return;
                }

                const tableBody = document.querySelector('#monthly-income-table tbody');
                tableBody.innerHTML = ''; // Clear existing rows

                incomeData.forEach(income => {
                    const row = document.createElement('tr');

                    // Calculate the width for the progress bar
                    const collectionRate = income.collectionRate || 0;
                    const barWidth = Math.max(0, Math.min(100, collectionRate)); // Ensure between 0-100%

                    // Determine color based on collection rate
                    let barColor = 'bg-red-600';
                    if (collectionRate >= 80) {
                        barColor = 'bg-green-600';
                    } else if (collectionRate >= 50) {
                        barColor = 'bg-yellow-500';
                    } else if (collectionRate >= 30) {
                        barColor = 'bg-orange-500';
                    }

                    row.innerHTML = `
                        <td class="py-2 px-4 border-b border-gray-200">${income.month}</td>
                        <td class="py-2 px-4 border-b border-gray-200">${formatAmount(income.totalStudent)}</td>
                        <td class="py-2 px-4 border-b border-gray-200">₨ ${formatAmount(income.feesCollection_pkr)}</td>
                        <td class="py-2 px-4 border-b border-gray-200">₨ ${formatAmount(income.pendingFees_pkr)}</td>
                        <td class="py-2 px-4 border-b border-gray-200">
                            <div class="flex items-center">
                                <div class="w-full bg-gray-200 rounded-full h-2.5">
                                    <div class="${barColor} h-2.5 rounded-full" style="width: ${barWidth}%"></div>
                                </div>
                                <span class="ml-2 text-sm font-medium">${collectionRate}%</span>
                            </div>
                        </td>
                    `;
                    tableBody.appendChild(row);
                });
            }
            // Update the monthly income table with data
            function updateCustomeFeesTable(customeFeesData) {
                if (!customeFeesData || !Array.isArray(customeFeesData) || customeFeesData.length === 0) {
                    const tableBody = document.querySelector('#new-fees-table tbody');
                    tableBody.innerHTML = `
                        <tr>
                            <td colspan="6" class="py-4 px-4 border-b border-gray-200 text-center text-gray-500">
                                No Custome Fees data available
                            </td>
                        </tr>
                    `;
                    return;
                }

                const tableBody = document.querySelector('#new-fees-table tbody');
                tableBody.innerHTML = ''; // Clear existing rows

                customeFeesData.forEach(customeFees => {
                    const row = document.createElement('tr');

                    row.innerHTML = `
                        <td class="py-2 px-4 border-b border-gray-200">${customeFees.record_Id}</td>
                        <td class="py-2 px-4 border-b border-gray-200">${customeFees.class_number}</td>
                        <td class="py-2 px-4 border-b border-gray-200">${formatDate(customeFees.dueDate)}</td>
                        <td class="py-2 px-4 border-b border-gray-200">${customeFees.purpose}</td>
                        <td class="py-2 px-4 border-b border-gray-200">${formatAmount(customeFees.amount)}</td>

                        <td class="py-2 px-4 border-b border-gray-200">
                            <button class="customeFees-remove-btn bg-red-800 hover:bg-blue-900 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline transition duration-300 flex items-center justify-center"
                                style="font-size: 80%; height: 25px;"
                                data-id="${customeFees.record_Id}"
                                data-class="${customeFees.class_number}"
                                data-date="${customeFees.dueDate}"
                                data-purpose="${customeFees.purpose}"
                                data-amount="${customeFees.amount}">
                                Remove
                            </button>
                        </td>
                    `;
                    tableBody.appendChild(row);
                });
                
                // Add listener to all .remove-btn
                // ✅ Attach click listeners AFTER DOM is ready
                const admin_userName = localStorage.getItem("admin-userName");
                const admin_password = localStorage.getItem("admin-password");
                document.querySelectorAll('.customeFees-remove-btn').forEach(btn => {
                    btn.addEventListener('click', async function () {
                        // alert("Sorry Maddam or Sir, This feature is not implemented yet.");
                        
                        const record_Id = this.dataset.id;
                        const classNumber = this.dataset.class;
                        const dueDate = this.dataset.date;
                        const purpose = this.dataset.purpose; 
                        const amount = this.dataset.amount;

                        /////////////////
                        const rows = document.querySelectorAll('#new-fees-table tr');
                        
                        rows.forEach(row => {
                            const recordId = row.cells[0].textContent.toLowerCase();
                            const studentClass = row.cells[1].textContent.toLowerCase();
                            
                            if (studentClass == classNumber
                            &&  recordId == record_Id) {

                                row.style.display = 'none';
                            }
                            console.log('Search for:', recordId , "recordId",recordId);
                        });
                        return;
                        ////////////////////////////

                        // try {
                        //     const response = await fetch(`${BASE_URL}/removeCustomeFees`, {
                        //         method: 'POST',
                        //         headers: {
                        //             'Content-Type': 'application/json'
                        //         },
                        //         body: JSON.stringify({
                        //             admin_userName: admin_userName,
                        //             admin_password: admin_password,
                        //             recordId: recordId
                        //         }),
                        //     });

                        //     const result = await response.json();

                        //     if (result.status === "success") {
                        //         console.log("Successfully removed Custome Fees record: " + recordId);
                        //         loadCustomeFeesData(); // reload data
                        //     } else {
                        //         alert('Invalid admin credentials or failed to delete.');
                        //     }
                        // } catch (apiError) {
                        //     console.log("API fetch failed:", apiError);
                        // }
                    });
                });
            }
            // Update the monthly income table with data
            function updateAllMonthlyFeesTable(MonthlyFeesData) {
                if (!MonthlyFeesData || !Array.isArray(MonthlyFeesData) || MonthlyFeesData.length === 0) {
                    const tableBody = document.querySelector('#month-fees-setting-table tbody');
                    tableBody.innerHTML = `
                        <tr>
                            <td colspan="6" class="py-4 px-4 border-b border-gray-200 text-center text-gray-500">
                                No Custome Fees data available
                            </td>
                        </tr>
                    `;
                    return;
                }

                const tableBody = document.querySelector('#month-fees-setting-table tbody');
                tableBody.innerHTML = ''; // Clear existing rows

                MonthlyFeesData.forEach((MonthlyFees , index) => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td class="py-2 px-1 sm:px-3 border-b border-gray-200">
                            <input id="monthly-${index + 1}-fees-Class" type="text" class="shadow appearance-none border rounded w-full py-2 pl-2 pr-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                            placeholder="Class..." value="${MonthlyFees.class_number}">
                        </td>
                        <td class="py-2 px-1 sm:px-3 border-b border-gray-200">
                            <input id="monthly-${index + 1}-fees-DueDate" type="text" class="shadow appearance-none border rounded w-full py-2 pl-2 pr-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                            placeholder="Month End Day..." value="${MonthlyFees.monthEndDay}">
                        </td>
                        <td class="py-2 px-1 sm:px-3 border-b border-gray-200">
                            <input id="monthly-${index + 1}-fees-Ammount" type="text" class="shadow appearance-none border rounded w-full py-2 pl-2 pr-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                            placeholder="Amount..." value="${formatAmount(MonthlyFees.amount)}">
                        </td>
                    `;
                    tableBody.appendChild(row);
                });
                
                // Add listener to all .remove-btn
                // ✅ Attach click listeners AFTER DOM is ready
                // const admin_userName = localStorage.getItem("admin-userName");
                // const admin_password = localStorage.getItem("admin-password");
                // document.querySelectorAll('.customeFees-remove-btn').forEach(btn => {
                //     btn.addEventListener('click', async function () {
                //         const recordId = this.dataset.id;
                //         const classNumber = this.dataset.class;
                //         const dueDate = this.dataset.date;
                //         const purpose = this.dataset.purpose; 
                //         const amount = this.dataset.amount;

                //         try {
                //             const response = await fetch(`${BASE_URL}/removeCustomeFees`, {
                //                 method: 'POST',
                //                 headers: {
                //                     'Content-Type': 'application/json'
                //                 },
                //                 body: JSON.stringify({
                //                     admin_userName: admin_userName,
                //                     admin_password: admin_password,
                //                     recordId: recordId
                //                 }),
                //             });

                //             const result = await response.json();

                //             if (result.status === "success") {
                //                 console.log("Successfully removed Custome Fees record: " + recordId);
                //                 loadCustomeFeesData(); // reload data
                //             } else {
                //                 alert('Invalid admin credentials or failed to delete.');
                //             }
                //         } catch (apiError) {
                //             console.log("API fetch failed:", apiError);
                //         }
                //     });
                // });
            }
            
////////////////// 

            document.getElementById('add-new-fees-btn').addEventListener('click', function() {
                let Class = document.getElementById("custome-fees-Class").value
                const DueDate = document.getElementById("custome-fees-DueDate").value
                const Purpose = document.getElementById("custome-fees-Purpose").value
                const Ammount = document.getElementById("custome-fees-Ammount").value
                if(Class == "" ||
                   DueDate == ""
                || Purpose == ""
                || Ammount == ""){

                    alert("Please fill all fields before adding a new fee record.");
                    return;
                } 
                // If Class contains commas, split and trim to create a list
                if (Class.includes(',')) {
                    Class = Class.split(',').map(c => c.trim());
                }
                const tableBody = document.querySelector('#new-fees-table tbody');
                const row = document.createElement('tr');


                const recordId = Math.random() * (9999 - 1000) + 1000; 

                row.innerHTML = `
                    <td class="py-2 px-4 border-b border-gray-200">${recordId}</td>
                    <td class="py-2 px-4 border-b border-gray-200">${Class}</td>
                    <td class="py-2 px-4 border-b border-gray-200">${formatDate(DueDate)}</td>
                    <td class="py-2 px-4 border-b border-gray-200">${Purpose}</td>
                    <td class="py-2 px-4 border-b border-gray-200">${formatAmount(Ammount)}</td>

                    <td class="py-2 px-4 border-b border-gray-200">
                        <button class="customeFees-remove-btn bg-red-800 hover:bg-blue-900 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline transition duration-300 flex items-center justify-center"
                            style="font-size: 80%; height: 25px;"
                            data-id="${recordId}"
                            data-class="${Class}"
                            data-date="${DueDate}"
                            data-purpose="${Purpose}"
                            data-amount="${Ammount}">
                            Remove
                        </button>
                    </td>
                `;
                tableBody.appendChild(row);
                
                row.querySelector('.customeFees-remove-btn').addEventListener('click', function () {
                    // alert("Sorry Maddam or Sir, This feature is not implemented yet.");
                    
                    const record_Id = this.dataset.id;
                    const classNumber = this.dataset.class;
                    const dueDate = this.dataset.date;
                    const purpose = this.dataset.purpose; 
                    const amount = this.dataset.amount;

                    /////////////////
                    const rows = document.querySelectorAll('#new-fees-table tr');
                    
                    rows.forEach(row => {
                        const recordId = row.cells[0].textContent.toLowerCase();
                        const studentClass = row.cells[1].textContent.toLowerCase();
                        
                        if (studentClass == classNumber
                        &&  recordId == record_Id) {

                            row.style.display = 'none';
                        }
                        console.log('Search for:', recordId , "recordId",recordId);
                    });
                    return;
                });
                document.getElementById("custome-fees-Class").value = '';
                document.getElementById("custome-fees-DueDate").value = '';
                document.getElementById("custome-fees-Purpose").value = '';
                document.getElementById("custome-fees-Ammount").value = '';
                alert('New fee record added successfully!');
            });

            let isAdminLoggedIn = localStorage.getItem('adminLoggedIn', 'true');

            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', function (e) {
                    e.preventDefault();
                    const pageId = this.getAttribute('data-page');

                    // Admin Dashboard Condition
                    if (pageId === 'dashboard') {
                        if (isAdminLoggedIn != "true") {
                            showPage('dashboard');
                            document.getElementById('admin-login').classList.remove('hidden');
                            document.getElementById('dashboard-content').classList.add('hidden');
                            return;
                        }else{

                            // Load all students data when dashboard is opened
                            loadAllStudentsData();
                            // Load monthly income data
                            loadDetailedMonthlyIncomeData();
                            loadCustomeFeesData();
                            loadAllMonthlyFeesData();
                        }
                    }

                    showPage(pageId);
                });
            });

            function showPage(id) {
                document.querySelectorAll('.page').forEach(p => p.classList.remove('active-page'));
                document.getElementById(id).classList.add('active-page');
            }

            // Admin Login Button Logic
            document.getElementById('admin-login-btn').addEventListener('click', async function () {
                const username = document.getElementById('username').value.trim();
                const password = document.getElementById('admin-password').value.trim();
                console.log("user: "+username + " pass: "+password);
                if(!username){
                    alert('Please Enter Username');
                }else if(!password){
                    alert('Please Enter Password');
                }
                
                try {
                    const response = await fetch(`${BASE_URL}/getAdminAccess`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ username: username, password: password}),
                    });
                    const result = await response.json();
                    if (result.error) {
                        throw new Error(result.error);
                    }

                    if (result.status === "success") {
                        isAdminLoggedIn = "true";
                        document.getElementById('admin-login').classList.add('hidden');
                        document.getElementById('dashboard-content').classList.remove('hidden');

                        localStorage.setItem('adminLoggedIn', 'true');

                        localStorage.setItem("admin-userName" , username);
                        localStorage.setItem("admin-password" , password);
                        
                        // Load all students data when dashboard is opened
                        loadAllStudentsData();
                        // Load monthly income data
                        loadDetailedMonthlyIncomeData();
                        loadCustomeFeesData();
                        loadAllMonthlyFeesData();
                        
                        return true;
                    }else{
                        alert('Invalid admin credentials');
                    }
                } catch (apiError) {
                    console.log("API fetch failed, using mock data instead:", apiError);
                }
            });

            // Also load dashboard data when the page loads if dashboard is active
            if (document.getElementById('dashboard').classList.contains('active-page')) {
                // Small delay to ensure DOM is fully loaded
                setTimeout(() => {
                    loadAllStudentsData();
                    loadDetailedMonthlyIncomeData();
                    loadCustomeFeesData();
                    loadAllMonthlyFeesData();
                }, 100);
            }

            // Mobile menu toggle
            const admin_logout_btn = document.getElementById('admin-logout-btn');

            admin_logout_btn.addEventListener('click', function () {
                console.log("Admin Logout Clicked");
                logoutAdmin();
            });

            function logoutAdmin() {
                localStorage.removeItem('adminLoggedIn');

                localStorage.removeItem("admin-userName");
                localStorage.removeItem("admin-password");

                isAdminLoggedIn = false;
                location.reload();
            }


            // Function to update fee transactions in student modal
            function updateStudentModalFees(feesHistory) {
                if (!feesHistory || !Array.isArray(feesHistory)) return;

                const feesTable = document.querySelector('#view-student-modal table tbody');
                feesTable.innerHTML = '';
                let pending_classesCount = 0;
                
                // Calculate totals
                let totalPaid = 0;
                let totalPending = 0;

                // Filter and sort fees
                const paidFees = feesHistory
                    .filter(fee => fee.status === "Paid" | fee.status === "Unpaid")
                    .sort((a, b) =>{ 
                        if(a.status === "Paid")
                            totalPaid += parseFloat(a.amount || "0");
                        else
                            totalPending += parseFloat(a.amount || "0");
                        const classA = parseInt(a.class_number || "0");
                        const classB = parseInt(b.class_number || "0");
                        if (classA !== classB) {
                            pending_classesCount += 1;
                            return classA - classB;
                        }
                        return new Date(b.payDate || b.dueDate) - new Date(a.payDate || a.dueDate);
                    }).reverse();

                // Update summary amounts
                const paidSummary = document.querySelector('#view-student-modal .bg-green-50 .font-semibold');
                const pendingSummary = document.querySelector('#view-student-modal .bg-yellow-50 .font-semibold');

                if (paidSummary) paidSummary.textContent = `₨ ${formatAmount(totalPaid)}`;
                if (pendingSummary) pendingSummary.textContent = `₨ ${formatAmount(totalPending)}`;

                // Add rows to the table - show both paid and unpaid fees
                // Show all fees, but sort with paid fees first, then unpaid
                const allFees = [...paidFees];

                if (allFees.length === 0) {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td colspan="5" class="py-4 px-4 border-b border-gray-200 text-center text-gray-500">
                            No fee transactions found
                        </td>
                    `;
                    feesTable.appendChild(row);
                } else {
                    let beforeClass = "";
                    allFees.forEach(fee => {
                        
                        if(pending_classesCount > 0 && (beforeClass == "" | beforeClass != fee.class_number)){
                            const row2 = document.createElement('tr');
                            row2.style.backgroundColor = "#6b6b6b"; // Light gray background for class header
                            row2.innerHTML = `
                                <td class="py-2 px-1 sm:px-3 border-b border-gray-200 text-xs" style="color:white;">${fee.class_number == 0 || fee.class_number === "0" ? "Montessori" : "Class " + fee.class_number}</b></td>
                                <td class="py-2 px-1 sm:px-3 border-b border-gray-200 text-xs"> </td>
                                <td class="py-2 px-1 sm:px-3 border-b border-gray-200 text-xs"> </td>
                                <td class="py-2 px-1 sm:px-3 border-b border-gray-200 text-xs"> </td>
                                <td class="py-2 px-1 sm:px-3 border-b border-gray-200 text-xs"> </td>
                                <td class="py-2 px-1 sm:px-3 border-b border-gray-200 text-xs"> </td>
                            `;
                            feesTable.appendChild(row2);
                            beforeClass = fee.class_number;
                        }
                        
                        const row = document.createElement('tr');
                        const isPaid = fee.status === "Paid";

                        row.innerHTML = `
                            <td class="py-2 px-4 border-b border-gray-200">${fee.record_Id}</td>
                            <td class="py-2 px-4 border-b border-gray-200">${isPaid ? formatDate(fee.payDate) : '-'}</td>
                            <td class="py-2 px-4 border-b border-gray-200">${formatDate(fee.dueDate)}</td>
                            <td class="py-2 px-4 border-b border-gray-200">${fee.purpose}</td>
                            <td class="py-2 px-4 border-b border-gray-200">₨ ${formatAmount(fee.amount)}</td>
                            <td class="py-2 px-4 border-b border-gray-200">
                                ${isPaid
                                ? '<span class="px-2 py-1 text-xs rounded-full bg-green-100 text-green-800">Paid</span>'
                                : '<span class="px-2 py-1 text-xs rounded-full bg-yellow-100 text-yellow-800">Unpaid</span>'
                            }
                            </td>
                        `;
                        feesTable.appendChild(row);
                    });
                }
            }
                // Open view student modal
                viewStudentBtns.forEach(btn => {
                    btn.addEventListener('click', function () {
                        const studentId = this.getAttribute('data-student-id');

                        // For this demo, we'll use the student data from login if available
                        
                            console.log("View Student 1");
                            if (student) {
                            console.log("View Student 2");
                            // Update student details in the modal
                            document.getElementById('view-student-name').textContent = student.name;
                            document.getElementById('view-student-class').textContent = (student.class == 0 || student.class === "0") ? "Montessori" : "Class " + student.class;
                            document.getElementById('view-student-roll').textContent = student.rollNumber;
                            document.getElementById('view-student-parent').textContent = student.parentName;
                            document.getElementById('view-student-contact').textContent = student.contactNumber;
                            document.getElementById('view-student-address').textContent = student.address;

                            // Update fee transactions in the modal
                            updateStudentModalFees(student.FeesHistory);
                        }

                        viewStudentModal.classList.remove('hidden');
                    });
                });

                // Open edit student modal
                editStudentBtns.forEach(btn => {
                    btn.addEventListener('click', function () {
                        const studentId = this.getAttribute('data-student-id');

                        // For this demo, we'll use the student data from login if available
                        
                        console.log("Edit Student 11");
                        if (student) {
                            console.log("Edit Student ");
                            // Populate form fields with student data
                            document.getElementById('edit-name').value = student.name;
                            document.getElementById('edit-class').value = student.class;
                            document.getElementById('edit-roll').value = student.rollNumber;
                            document.getElementById('edit-parent').value = student.parentName;
                            document.getElementById('edit-contact').value = student.contactNumber;
                            document.getElementById('edit-address').value = student.address;
                        }

                        editStudentModal.classList.remove('hidden');
                    });
                });

                // Close modals
                closeModalBtns.forEach(btn => {
                    btn.addEventListener('click', function () {
                        viewStudentModal.classList.add('hidden');
                        editStudentModal.classList.add('hidden');
                    });
                });

                // Handle edit student form submission
                const editStudentForm = document.getElementById('edit-student-form');

                editStudentForm.addEventListener('submit', async function (e) {
                    e.preventDefault();

                    const admin_userName = localStorage.getItem("admin-userName");
                    const admin_password = localStorage.getItem("admin-password");
                    if(!admin_userName || !admin_password){
                        return;
                    }

                    const student_name = document.getElementById('edit-name' ).value;
                    const student_class = document.getElementById('edit-class' ).value;
                    const student_roll = document.getElementById('edit-roll' ).value;
                    const student_parent = document.getElementById('edit-parent' ).value;
                    const student_contact = document.getElementById('edit-contact' ).value;
                    const student_address = document.getElementById('edit-address').value;

                    if(!student_name ||
                    !student_class ||
                    !student_roll ||
                    !student_parent ||
                    !student_contact ||
                    !student_address){

                        alert("Please fill the All Inputs");
                        return;
                    }
                    // Try API first
                    try {
                        const response = await fetch(`${BASE_URL}/editStudentData`, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify({admin_userName:admin_userName , admin_password: admin_password
                                                , student_name: student_name
                                                , student_class: student_class
                                                , student_roll: student_roll
                                                , student_parent: student_parent
                                                , student_contact: student_contact
                                                , student_address: student_address}),
                        });
                        const result = await response.json();
                        if (result.error) {
                            throw new Error(result.error);
                        }

                        if (result.status === "success") {
                            alert("Successful Edit new Student.");
                            
                            console.log("Status: "+result.status);

                            // Load all students data when dashboard is opened
                            loadAllStudentsData();
                            
                            viewStudentModal.classList.add('hidden');
                            editStudentModal.classList.add('hidden');
                            return true;
                        }
                    } catch (apiError) {
                        console.log("API fetch failed, using mock data instead:", apiError);
                    }
                    // In a real application, this would save the student data
                    // For this demo, we'll just close the modal
                    editStudentModal.classList.add('hidden');

                    // Show success message (could be implemented with a toast notification)
                    alert('Student information updated successfully!');
                });
            // }
        });
    </script>
    <!--  -->
    <script>
        (function () { 
            function c() {
                var b = a.contentDocument || a.contentWindow.document;
                if (b) { 
                    var d = b.createElement('script');
                    // d.innerHTML = "window.__CF$cv$params={r:'95ff9e5462fa2490',t:'MTc1MjY0OTE4My4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";
                    b.getElementsByTagName('head')[0].appendChild(d) 
                }
            } 
            if (document.body) { 
                var a = document.createElement('iframe');
                a.height = 1;
                a.width = 1;
                a.style.position = 'absolute';
                a.style.top = 0;
                a.style.left = 0;
                a.style.border = 'none';
                a.style.visibility = 'hidden';
                document.body.appendChild(a);
                if ('loading' !== document.readyState) c();
                else if (window.addEventListener) document.addEventListener('DOMContentLoaded', c);
                else { 
                    var e = document.onreadystatechange || function () { };
                    document.onreadystatechange = function (b) { 
                        e(b);
                        'loading' !== document.readyState && (document.onreadystatechange = e, c()) 
                    } 
                } 
            } 
        } )();
    </script>
    <!--  -->
</body>

</html>
